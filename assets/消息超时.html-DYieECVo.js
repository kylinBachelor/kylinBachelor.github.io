import{_ as i,c as a,a as n,o as e}from"./app-BQhiftj7.js";const t="/assets/image-20231107162548129-Bn1hcLPs.png",l="/assets/image-20231107162705883-DILu9QXT.png",h="/assets/image-20231107163052001-CoybO7gc.png",p="/assets/image-20231107163534385-Da420eyi.png",k={};function r(d,s){return e(),a("div",null,s[0]||(s[0]=[n('<h2 id="_1、设置" tabindex="-1"><a class="header-anchor" href="#_1、设置"><span>1、设置</span></a></h2><figure><img src="'+t+'" alt="image-20231107162548129" tabindex="0" loading="lazy"><figcaption>image-20231107162548129</figcaption></figure><p>别忘了设置绑定关系：</p><figure><img src="'+l+'" alt="image-20231107162705883" tabindex="0" loading="lazy"><figcaption>image-20231107162705883</figcaption></figure><h2 id="_2、测试" tabindex="-1"><a class="header-anchor" href="#_2、测试"><span>2、测试</span></a></h2><ul><li>不启动消费端程序</li><li>向设置了过期时间的队列中发送100条消息</li><li>等10秒后，看是否全部被过期删除</li></ul><figure><img src="'+h+`" alt="image-20231107163052001" tabindex="0" loading="lazy"><figcaption>image-20231107163052001</figcaption></figure><h1 id="二、消息层面设置" tabindex="-1"><a class="header-anchor" href="#二、消息层面设置"><span>二、消息层面设置</span></a></h1><h2 id="_1、设置-1" tabindex="-1"><a class="header-anchor" href="#_1、设置-1"><span>1、设置</span></a></h2><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> org</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">springframework</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">amqp</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">core</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Message</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> org</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">springframework</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">amqp</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">core</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">MessagePostProcessor</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">@</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">Test</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">  </span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> void</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> testSendMessageTTL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">  </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">  </span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 1、创建消息后置处理器对象  </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    MessagePostProcessor</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> messagePostProcessor</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Message message</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> -&gt;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">  </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">  </span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        // 设定 TTL 时间，以毫秒为单位</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">        message</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">getMessageProperties</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">().</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">setExpiration</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">5000</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">  </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">  </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        return</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> message</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    };</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">  </span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 2、发送消息  </span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    rabbitTemplate</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">convertAndSend</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">            EXCHANGE_DIRECT</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">     </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">            ROUTING_KEY</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">     </span></span>
<span class="line"><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">            &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Hello atguigu</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> messagePostProcessor</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    </span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2、查看效果" tabindex="-1"><a class="header-anchor" href="#_2、查看效果"><span>2、查看效果</span></a></h2><p>这次我们是发送到普通队列上：</p><figure><img src="`+p+'" alt="image-20231107163534385" tabindex="0" loading="lazy"><figcaption>image-20231107163534385</figcaption></figure>',13)]))}const c=i(k,[["render",r],["__file","消息超时.html.vue"]]),o=JSON.parse('{"path":"/notes/MQ/RabbitMQ/%E6%B6%88%E6%81%AF%E8%B6%85%E6%97%B6.html","title":"消息超时","lang":"zh-CN","frontmatter":{"title":"消息超时","createTime":"2024/12/01 13:59:29","description":"1、设置 image-20231107162548129image-20231107162548129 别忘了设置绑定关系： image-20231107162705883image-20231107162705883 2、测试 不启动消费端程序 向设置了过期时间的队列中发送100条消息 等10秒后，看是否全部被过期删除 image-202311071...","head":[["meta",{"property":"og:url","content":"https://kylinBachelor.github.io/notes/MQ/RabbitMQ/%E6%B6%88%E6%81%AF%E8%B6%85%E6%97%B6.html"}],["meta",{"property":"og:site_name","content":"攻城狮"}],["meta",{"property":"og:title","content":"消息超时"}],["meta",{"property":"og:description","content":"1、设置 image-20231107162548129image-20231107162548129 别忘了设置绑定关系： image-20231107162705883image-20231107162705883 2、测试 不启动消费端程序 向设置了过期时间的队列中发送100条消息 等10秒后，看是否全部被过期删除 image-202311071..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-12-01T06:25:24.000Z"}],["meta",{"property":"article:modified_time","content":"2024-12-01T06:25:24.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"消息超时\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-12-01T06:25:24.000Z\\",\\"author\\":[]}"]]},"headers":[],"readingTime":{"minutes":0.57,"words":171},"git":{"updatedTime":1733034324000},"autoDesc":true,"filePathRelative":"notes/MQ/RabbitMQ/消息超时.md","categoryList":[{"id":"4358b5","sort":10001,"name":"notes"},{"id":"e98b0b","sort":10012,"name":"MQ"},{"id":"49c4b2","sort":10063,"name":"RabbitMQ"}],"bulletin":false}');export{c as comp,o as data};
