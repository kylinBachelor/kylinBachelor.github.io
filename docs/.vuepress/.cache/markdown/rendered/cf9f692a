{"content":"<h1 id=\"使用docker部署方式\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#使用docker部署方式\"><span>使用Docker部署方式</span></a></h1>\n<h2 id=\"_1-不使用harbor仓库部署\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-不使用harbor仓库部署\"><span>1. 不使用Harbor仓库部署</span></a></h2>\n<blockquote>\n<p>本地可以连接远程Docker，以Dcoker进行构建镜像（该Docker需为部署自己服务程序的服务器上的Docker,因为构建镜像时是直接构建到远程Docker上的）。</p>\n</blockquote>\n<h3 id=\"_1-1-前提准备\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-1-前提准备\"><span>1.1 前提准备</span></a></h3>\n<h4 id=\"_1-1-1-maven-docker打包插件-fabric8及远程docker配置\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-1-1-maven-docker打包插件-fabric8及远程docker配置\"><span>1.1.1 maven docker打包插件：fabric8及远程Docker配置</span></a></h4>\n<div class=\"language-xml line-numbers-mode\" data-ext=\"xml\" data-title=\"xml\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">&#x3C;!--maven  docker 打包插件 --></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">plugin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">groupId</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">io.fabric8</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">groupId</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">artifactId</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">docker-maven-plugin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">artifactId</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">version</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">${docker.plugin.version}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">version</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">configuration</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">dockerHost</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">${docker.host}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">dockerHost</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">registry</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">${docker.registry}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">registry</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">authConfig</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">            &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">push</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">                &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">username</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">${docker.username}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">username</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">                &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">password</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">${docker.password}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">password</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">            &#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">push</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        &#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">authConfig</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">images</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">            &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">image</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">                &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">${docker.registry}/${docker.namespace}/${project.name}:${project.version}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">                &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">build</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">                    &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">dockerFile</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">${project.basedir}/Dockerfile</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">dockerFile</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">                &#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">build</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">            &#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">image</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        &#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">images</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    &#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">configuration</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">plugin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h4 id=\"_1-1-2-构建镜像的dockerfile文件\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-1-2-构建镜像的dockerfile文件\"><span>1.1.2 构建镜像的Dockerfile文件</span></a></h4>\n<div class=\"language-dockerfile line-numbers-mode\" data-ext=\"dockerfile\" data-title=\"dockerfile\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">FROM</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ubuntu</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">MAINTAINER</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> congpeitong@shundesoft.com</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 设置工作目录</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">WORKDIR</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> /pigx-boot</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 设置JAR位置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">ARG</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> JAR_FILE=target/pigx-boot.jar</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 将本地的Java源代码赋值到容器内</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">COPY</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ${JAR_FILE} app.jar</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 暴露端口给物理机映射</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">EXPOSE</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> 9999</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">ENV</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> TZ=Asia/Shanghai JAVA_OPTS=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">\"-Xms512m -Xmx1024m -Djava.security.egd=file:/dev/./urandom\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 运行编译后的Java程序</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">CMD</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sleep 60; java $JAVA_OPTS -jar app.jar</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h4 id=\"_1-1-3-生成好的程序jar包\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-1-3-生成好的程序jar包\"><span>1.1.3 生成好的程序jar包</span></a></h4>\n<h3 id=\"_1-2-部署\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-2-部署\"><span>1.2 部署</span></a></h3>\n<h4 id=\"_1-2-1-maven命令部署\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-2-1-maven命令部署\"><span>1.2.1 maven命令部署</span></a></h4>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">mvn</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> clean</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> package</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> docker:stop</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> docker:remove</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> docker:build</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> docker:run</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><ul>\n<li>docker:stop 停止并删除docker容器</li>\n<li>docker:remove 删除镜像</li>\n<li>docker:build 构建镜像</li>\n<li>docker:run 创建并启动docker容器</li>\n</ul>\n<h4 id=\"_1-2-2-idea部署\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-2-2-idea部署\"><span>1.2.2 idea部署</span></a></h4>\n<p><img src=\"@source/notes/Docker/一般部署方式/assets/image-20240716094139983.png\" alt=\"image-20240716094139983\"></p>\n<h2 id=\"_2-使用harbor仓库部署\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-使用harbor仓库部署\"><span>2. 使用Harbor仓库部署</span></a></h2>\n<h3 id=\"_2-1-前提准备\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-1-前提准备\"><span>2.1 前提准备</span></a></h3>\n<p>和不使用Harbor的前提准备一致，配置好Harbor信息就行了</p>\n<h3 id=\"_2-2-部署\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-2-部署\"><span>2.2 部署</span></a></h3>\n<p>本地使用build生成镜像-》通过push将生成的镜像上传到Harbor仓库-》部署服务器通过docker pull命令从Harbor仓库拉取然后run启动就行了。</p>\n","env":{"base":"/","filePath":"C:/Users/kylinBachelor/Desktop/kylinBachelor.github.io/docs/notes/Docker/一般部署方式/index.md","filePathRelative":"notes/Docker/一般部署方式/index.md","frontmatter":{},"sfcBlocks":{"template":{"type":"template","content":"<template><h1 id=\"使用docker部署方式\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#使用docker部署方式\"><span>使用Docker部署方式</span></a></h1>\n<h2 id=\"_1-不使用harbor仓库部署\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-不使用harbor仓库部署\"><span>1. 不使用Harbor仓库部署</span></a></h2>\n<blockquote>\n<p>本地可以连接远程Docker，以Dcoker进行构建镜像（该Docker需为部署自己服务程序的服务器上的Docker,因为构建镜像时是直接构建到远程Docker上的）。</p>\n</blockquote>\n<h3 id=\"_1-1-前提准备\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-1-前提准备\"><span>1.1 前提准备</span></a></h3>\n<h4 id=\"_1-1-1-maven-docker打包插件-fabric8及远程docker配置\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-1-1-maven-docker打包插件-fabric8及远程docker配置\"><span>1.1.1 maven docker打包插件：fabric8及远程Docker配置</span></a></h4>\n<div class=\"language-xml line-numbers-mode\" data-ext=\"xml\" data-title=\"xml\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">&#x3C;!--maven  docker 打包插件 --></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">plugin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">groupId</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">io.fabric8</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">groupId</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">artifactId</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">docker-maven-plugin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">artifactId</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">version</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">${docker.plugin.version}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">version</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">configuration</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">dockerHost</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">${docker.host}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">dockerHost</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">registry</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">${docker.registry}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">registry</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">authConfig</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">            &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">push</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">                &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">username</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">${docker.username}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">username</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">                &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">password</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">${docker.password}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">password</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">            &#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">push</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        &#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">authConfig</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">images</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">            &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">image</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">                &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">${docker.registry}/${docker.namespace}/${project.name}:${project.version}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">                &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">build</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">                    &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">dockerFile</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">${project.basedir}/Dockerfile</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">dockerFile</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">                &#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">build</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">            &#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">image</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        &#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">images</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    &#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">configuration</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">plugin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h4 id=\"_1-1-2-构建镜像的dockerfile文件\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-1-2-构建镜像的dockerfile文件\"><span>1.1.2 构建镜像的Dockerfile文件</span></a></h4>\n<div class=\"language-dockerfile line-numbers-mode\" data-ext=\"dockerfile\" data-title=\"dockerfile\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">FROM</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ubuntu</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">MAINTAINER</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> congpeitong@shundesoft.com</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 设置工作目录</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">WORKDIR</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> /pigx-boot</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 设置JAR位置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">ARG</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> JAR_FILE=target/pigx-boot.jar</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 将本地的Java源代码赋值到容器内</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">COPY</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ${JAR_FILE} app.jar</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 暴露端口给物理机映射</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">EXPOSE</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> 9999</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">ENV</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> TZ=Asia/Shanghai JAVA_OPTS=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">\"-Xms512m -Xmx1024m -Djava.security.egd=file:/dev/./urandom\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 运行编译后的Java程序</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">CMD</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sleep 60; java $JAVA_OPTS -jar app.jar</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h4 id=\"_1-1-3-生成好的程序jar包\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-1-3-生成好的程序jar包\"><span>1.1.3 生成好的程序jar包</span></a></h4>\n<h3 id=\"_1-2-部署\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-2-部署\"><span>1.2 部署</span></a></h3>\n<h4 id=\"_1-2-1-maven命令部署\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-2-1-maven命令部署\"><span>1.2.1 maven命令部署</span></a></h4>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">mvn</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> clean</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> package</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> docker:stop</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> docker:remove</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> docker:build</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> docker:run</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><ul>\n<li>docker:stop 停止并删除docker容器</li>\n<li>docker:remove 删除镜像</li>\n<li>docker:build 构建镜像</li>\n<li>docker:run 创建并启动docker容器</li>\n</ul>\n<h4 id=\"_1-2-2-idea部署\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-2-2-idea部署\"><span>1.2.2 idea部署</span></a></h4>\n<p><img src=\"@source/notes/Docker/一般部署方式/assets/image-20240716094139983.png\" alt=\"image-20240716094139983\"></p>\n<h2 id=\"_2-使用harbor仓库部署\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-使用harbor仓库部署\"><span>2. 使用Harbor仓库部署</span></a></h2>\n<h3 id=\"_2-1-前提准备\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-1-前提准备\"><span>2.1 前提准备</span></a></h3>\n<p>和不使用Harbor的前提准备一致，配置好Harbor信息就行了</p>\n<h3 id=\"_2-2-部署\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-2-部署\"><span>2.2 部署</span></a></h3>\n<p>本地使用build生成镜像-》通过push将生成的镜像上传到Harbor仓库-》部署服务器通过docker pull命令从Harbor仓库拉取然后run启动就行了。</p>\n</template>","contentStripped":"<h1 id=\"使用docker部署方式\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#使用docker部署方式\"><span>使用Docker部署方式</span></a></h1>\n<h2 id=\"_1-不使用harbor仓库部署\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-不使用harbor仓库部署\"><span>1. 不使用Harbor仓库部署</span></a></h2>\n<blockquote>\n<p>本地可以连接远程Docker，以Dcoker进行构建镜像（该Docker需为部署自己服务程序的服务器上的Docker,因为构建镜像时是直接构建到远程Docker上的）。</p>\n</blockquote>\n<h3 id=\"_1-1-前提准备\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-1-前提准备\"><span>1.1 前提准备</span></a></h3>\n<h4 id=\"_1-1-1-maven-docker打包插件-fabric8及远程docker配置\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-1-1-maven-docker打包插件-fabric8及远程docker配置\"><span>1.1.1 maven docker打包插件：fabric8及远程Docker配置</span></a></h4>\n<div class=\"language-xml line-numbers-mode\" data-ext=\"xml\" data-title=\"xml\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">&#x3C;!--maven  docker 打包插件 --></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">plugin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">groupId</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">io.fabric8</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">groupId</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">artifactId</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">docker-maven-plugin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">artifactId</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">version</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">${docker.plugin.version}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">version</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">configuration</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">dockerHost</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">${docker.host}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">dockerHost</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">registry</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">${docker.registry}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">registry</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">authConfig</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">            &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">push</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">                &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">username</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">${docker.username}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">username</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">                &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">password</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">${docker.password}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">password</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">            &#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">push</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        &#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">authConfig</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">images</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">            &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">image</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">                &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">${docker.registry}/${docker.namespace}/${project.name}:${project.version}</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">                &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">build</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">                    &#x3C;</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">dockerFile</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">${project.basedir}/Dockerfile</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">dockerFile</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">                &#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">build</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">            &#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">image</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">        &#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">images</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">    &#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">configuration</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">&#x3C;/</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">plugin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">></span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h4 id=\"_1-1-2-构建镜像的dockerfile文件\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-1-2-构建镜像的dockerfile文件\"><span>1.1.2 构建镜像的Dockerfile文件</span></a></h4>\n<div class=\"language-dockerfile line-numbers-mode\" data-ext=\"dockerfile\" data-title=\"dockerfile\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">FROM</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ubuntu</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">MAINTAINER</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> congpeitong@shundesoft.com</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 设置工作目录</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">WORKDIR</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> /pigx-boot</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 设置JAR位置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">ARG</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> JAR_FILE=target/pigx-boot.jar</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 将本地的Java源代码赋值到容器内</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">COPY</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> ${JAR_FILE} app.jar</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 暴露端口给物理机映射</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">EXPOSE</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> 9999</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">ENV</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> TZ=Asia/Shanghai JAVA_OPTS=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">\"-Xms512m -Xmx1024m -Djava.security.egd=file:/dev/./urandom\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 运行编译后的Java程序</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">CMD</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sleep 60; java $JAVA_OPTS -jar app.jar</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h4 id=\"_1-1-3-生成好的程序jar包\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-1-3-生成好的程序jar包\"><span>1.1.3 生成好的程序jar包</span></a></h4>\n<h3 id=\"_1-2-部署\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-2-部署\"><span>1.2 部署</span></a></h3>\n<h4 id=\"_1-2-1-maven命令部署\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-2-1-maven命令部署\"><span>1.2.1 maven命令部署</span></a></h4>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">mvn</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> clean</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> package</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> docker:stop</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> docker:remove</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> docker:build</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> docker:run</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><ul>\n<li>docker:stop 停止并删除docker容器</li>\n<li>docker:remove 删除镜像</li>\n<li>docker:build 构建镜像</li>\n<li>docker:run 创建并启动docker容器</li>\n</ul>\n<h4 id=\"_1-2-2-idea部署\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-2-2-idea部署\"><span>1.2.2 idea部署</span></a></h4>\n<p><img src=\"@source/notes/Docker/一般部署方式/assets/image-20240716094139983.png\" alt=\"image-20240716094139983\"></p>\n<h2 id=\"_2-使用harbor仓库部署\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-使用harbor仓库部署\"><span>2. 使用Harbor仓库部署</span></a></h2>\n<h3 id=\"_2-1-前提准备\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-1-前提准备\"><span>2.1 前提准备</span></a></h3>\n<p>和不使用Harbor的前提准备一致，配置好Harbor信息就行了</p>\n<h3 id=\"_2-2-部署\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-2-部署\"><span>2.2 部署</span></a></h3>\n<p>本地使用build生成镜像-》通过push将生成的镜像上传到Harbor仓库-》部署服务器通过docker pull命令从Harbor仓库拉取然后run启动就行了。</p>\n","tagOpen":"<template>","tagClose":"</template>"},"script":null,"scriptSetup":null,"scripts":[],"styles":[],"customBlocks":[]},"content":"\n# 使用Docker部署方式\r\n\r\n## 1. 不使用Harbor仓库部署\r\n\r\n> 本地可以连接远程Docker，以Dcoker进行构建镜像（该Docker需为部署自己服务程序的服务器上的Docker,因为构建镜像时是直接构建到远程Docker上的）。\r\n\r\n### 1.1 前提准备\r\n\r\n#### 1.1.1 maven docker打包插件：fabric8及远程Docker配置\r\n\r\n```xml\r\n<!--maven  docker 打包插件 -->\r\n<plugin>\r\n    <groupId>io.fabric8</groupId>\r\n    <artifactId>docker-maven-plugin</artifactId>\r\n    <version>${docker.plugin.version}</version>\r\n    <configuration>\r\n        <dockerHost>${docker.host}</dockerHost>\r\n        <registry>${docker.registry}</registry>\r\n        <authConfig>\r\n            <push>\r\n                <username>${docker.username}</username>\r\n                <password>${docker.password}</password>\r\n            </push>\r\n        </authConfig>\r\n        <images>\r\n            <image>\r\n                <name>${docker.registry}/${docker.namespace}/${project.name}:${project.version}</name>\r\n                <build>\r\n                    <dockerFile>${project.basedir}/Dockerfile</dockerFile>\r\n                </build>\r\n            </image>\r\n        </images>\r\n    </configuration>\r\n</plugin>\r\n```\r\n\r\n\r\n\r\n#### 1.1.2 构建镜像的Dockerfile文件\r\n\r\n```dockerfile\r\nFROM ubuntu\r\n\r\nMAINTAINER congpeitong@shundesoft.com\r\n\r\n# 设置工作目录\r\nWORKDIR /pigx-boot\r\n# 设置JAR位置\r\nARG JAR_FILE=target/pigx-boot.jar\r\n# 将本地的Java源代码赋值到容器内\r\nCOPY ${JAR_FILE} app.jar\r\n# 暴露端口给物理机映射\r\nEXPOSE 9999\r\n\r\nENV TZ=Asia/Shanghai JAVA_OPTS=\"-Xms512m -Xmx1024m -Djava.security.egd=file:/dev/./urandom\"\r\n# 运行编译后的Java程序\r\nCMD sleep 60; java $JAVA_OPTS -jar app.jar\r\n```\r\n\r\n#### 1.1.3 生成好的程序jar包\r\n\r\n\r\n\r\n### 1.2 部署\r\n\r\n#### 1.2.1 maven命令部署\r\n\r\n```sh\r\nmvn clean package docker:stop docker:remove docker:build docker:run\r\n```\r\n\r\n+ docker:stop 停止并删除docker容器\r\n+ docker:remove 删除镜像\r\n+ docker:build 构建镜像\r\n+ docker:run 创建并启动docker容器\r\n\r\n#### 1.2.2 idea部署\r\n\r\n![image-20240716094139983](./assets/image-20240716094139983.png)\r\n\r\n## 2. 使用Harbor仓库部署\r\n\r\n### 2.1 前提准备\r\n\r\n和不使用Harbor的前提准备一致，配置好Harbor信息就行了\r\n\r\n### 2.2 部署\r\n\r\n本地使用build生成镜像-》通过push将生成的镜像上传到Harbor仓库-》部署服务器通过docker pull命令从Harbor仓库拉取然后run启动就行了。","excerpt":"","includedFiles":[],"tasklists":0,"title":"使用Docker部署方式","headers":[{"level":2,"title":"1. 不使用Harbor仓库部署","slug":"_1-不使用harbor仓库部署","link":"#_1-不使用harbor仓库部署","children":[{"level":3,"title":"1.1 前提准备","slug":"_1-1-前提准备","link":"#_1-1-前提准备","children":[]},{"level":3,"title":"1.2 部署","slug":"_1-2-部署","link":"#_1-2-部署","children":[]}]},{"level":2,"title":"2. 使用Harbor仓库部署","slug":"_2-使用harbor仓库部署","link":"#_2-使用harbor仓库部署","children":[{"level":3,"title":"2.1 前提准备","slug":"_2-1-前提准备","link":"#_2-1-前提准备","children":[]},{"level":3,"title":"2.2 部署","slug":"_2-2-部署","link":"#_2-2-部署","children":[]}]}]}}
