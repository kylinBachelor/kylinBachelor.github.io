{"content":"<h1 id=\"使用dockerfile制作基础镜像\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#使用dockerfile制作基础镜像\"><span>使用Dockerfile制作基础镜像</span></a></h1>\n<blockquote>\n<p>=== 这里基础镜像使用的时centos:7</p>\n</blockquote>\n<h2 id=\"_1-制作java17的dockerfile\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-制作java17的dockerfile\"><span>1. 制作java17的Dockerfile</span></a></h2>\n<h3 id=\"_1-1-dockerfile文件\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-1-dockerfile文件\"><span>1.1 Dockerfile文件</span></a></h3>\n<div class=\"language-dockerfile line-numbers-mode\" data-ext=\"dockerfile\" data-title=\"dockerfile\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span>FROM centos:7</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span># 配置Java17环境变量</span></span>\n<span class=\"line\"><span>ADD jdk-17_linux-x64_bin.tar.gz /usr/lib/</span></span>\n<span class=\"line\"><span>ENV JAVA_HOME=/usr/lib/jdk-17.0.10</span></span>\n<span class=\"line\"><span>ENV CLASSPATH=.:${JAVA_HOME}/jre/lib/rt.jar:${JAVA_HOME}/lib/dt.jar:${JAVA_HOME}/lib/tools.jar</span></span>\n<span class=\"line\"><span>ENV PATH=$PATH:${JAVA_HOME}/bin</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>CMD /bin/bash</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container warning\">\n<p class=\"hint-container-title\">注意</p>\n<p>jdk17 tar包要跟Dockerfile在同一个目录下，如果tar包使用绝对路径生成镜像的时候会报错</p>\n</div>\n<h3 id=\"_1-2-执行构建命令\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-2-执行构建命令\"><span>1.2 执行构建命令</span></a></h3>\n<blockquote>\n<p>=== 安装包、Dockerfile文件、命令执行 都在同一个目录下</p>\n</blockquote>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> build</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -t</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [镜像名] </span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">.</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 例如</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> build</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -t</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> centos7_jdk17</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> .</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_2-配置镜像\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-配置镜像\"><span>2. 配置镜像</span></a></h2>\n<blockquote>\n<p>=== 进入镜像配置Java环境所必须的一些依赖</p>\n</blockquote>\n<h3 id=\"_2-1-配置yum\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-1-配置yum\"><span>2.1 配置yum</span></a></h3>\n<p>可看阿里云官方的设置方式</p>\n<figure><img src=\"@source/notes/Docker/制作基础镜像/assets/image-20240715135505062.png\" alt=\"image-20240715135505062\" tabindex=\"0\" loading=\"lazy\"><figcaption>image-20240715135505062</figcaption></figure>\n<h4 id=\"_2-1-1-备份自带的yum配置\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-1-1-备份自带的yum配置\"><span>2.1.1 备份自带的yum配置</span></a></h4>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">cd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /etc/yum.conf.d</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">mkdir</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> bak</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">mv</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> *</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">.repo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> bak</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h4 id=\"_2-1-2-设置新的yum源\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-1-2-设置新的yum源\"><span>2.1.2 设置新的yum源</span></a></h4>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">vi</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> Centos-base.repo</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>设置阿里基础镜像源</p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># CentOS-Base.repo</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># The mirror system uses the connecting IP address of the client and the</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># update status of each mirror to pick mirrors that are updated to and</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># geographically close to the client.  You should use this for CentOS updates</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># unless you are manually picking other mirrors.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># If the mirrorlist= does not work for you, as a fall back you can try the </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># remarked out baseurl= line instead.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">base</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">CentOS-8.5.2111</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> Base</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mirrors.aliyun.com</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">baseurl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos-vault/8.5.2111/BaseOS/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$basearch</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.aliyuncs.com/centos-vault/8.5.2111/BaseOS/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.cloud.aliyuncs.com/centos-vault/8.5.2111/BaseOS/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgcheck</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgkey</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-Official</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#additional packages that may be useful</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">extras</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">CentOS-8.5.2111</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> Extras</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mirrors.aliyun.com</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">baseurl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos-vault/8.5.2111/extras/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$basearch</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.aliyuncs.com/centos-vault/8.5.2111/extras/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.cloud.aliyuncs.com/centos-vault/8.5.2111/extras/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgcheck</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgkey</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-Official</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#additional packages that extend functionality of existing packages</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">centosplus</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">CentOS-8.5.2111</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> Plus</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mirrors.aliyun.com</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">baseurl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos-vault/8.5.2111/centosplus/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$basearch</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.aliyuncs.com/centos-vault/8.5.2111/centosplus/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.cloud.aliyuncs.com/centos-vault/8.5.2111/centosplus/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgcheck</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">enabled</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgkey</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-Official</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">PowerTools</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">CentOS-8.5.2111</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> PowerTools</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mirrors.aliyun.com</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">baseurl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos-vault/8.5.2111/PowerTools/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$basearch</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.aliyuncs.com/centos-vault/8.5.2111/PowerTools/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.cloud.aliyuncs.com/centos-vault/8.5.2111/PowerTools/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgcheck</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">enabled</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgkey</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-Official</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">AppStream</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">CentOS-8.5.2111</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> AppStream</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mirrors.aliyun.com</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">baseurl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos-vault/8.5.2111/AppStream/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$basearch</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.aliyuncs.com/centos-vault/8.5.2111/AppStream/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.cloud.aliyuncs.com/centos-vault/8.5.2111/AppStream/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgcheck</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgkey</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-Official</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>使用 <strong>yum list</strong> 测试一下，如果包列表则是成功</p>\n<h2 id=\"_3-配置java运行所需要的依赖\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-配置java运行所需要的依赖\"><span>3. 配置Java运行所需要的依赖</span></a></h2>\n<h3 id=\"_3-1-配置-libfreetype-so-6-库\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-1-配置-libfreetype-so-6-库\"><span>3.1 配置 <strong>libfreetype.so.6</strong> 库</span></a></h3>\n<div class=\"hint-container note\">\n<p class=\"hint-container-title\">注</p>\n<p>libfreetype.so.6是一个在Linux系统中的动态链接库文件，它是由FreeType字体渲染引擎提供的</p>\n<p>功能：</p>\n<ol>\n<li>字体文件支持</li>\n<li>文字渲染</li>\n</ol>\n</div>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 对于Debain的系统，如ubuntu</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> apt-get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> update</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> apt-get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> libfreetype6</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 对于RHEL系统， 如centos, fedora</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> yum</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> freetype</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container note\">\n<p class=\"hint-container-title\">注</p>\n<p>如果未安装则运行Java时报错如下：</p>\n<p>Caused by: java.lang.ExceptionInInitializerError: Exception java.lang.UnsatisfiedLinkError: /usr/lib/jdk-17.0.10/lib/libfontmanager.so: libfreetype.so.6: cannot open shared object file: No such file or directory [in thread &quot;main&quot;]</p>\n</div>\n<h3 id=\"_3-2-配置-字体\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-配置-字体\"><span>3.2 配置 字体</span></a></h3>\n<blockquote>\n<p>=== 如果缺少字体，对于访问验证码时会出现问题</p>\n</blockquote>\n<p>报错如下：</p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">jakarta.servlet.ServletException:</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> Handler</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> dispatch</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> failed:</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> java.lang.InternalError:</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> java.lang.reflect.InvocationTargetException</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.springframework.web.servlet.DispatcherServlet.doDispatch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">DispatcherServlet.java:1096</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.springframework.web.servlet.DispatcherServlet.doService</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">DispatcherServlet.java:974</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.springframework.web.servlet.FrameworkServlet.processRequest</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">FrameworkServlet.java:1011</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.springframework.web.servlet.FrameworkServlet.doGet</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">FrameworkServlet.java:903</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> jakarta.servlet.http.HttpServlet.service</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">HttpServlet.java:564</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.springframework.web.servlet.FrameworkServlet.service</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">FrameworkServlet.java:885</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> jakarta.servlet.http.HttpServlet.service</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">HttpServlet.java:658</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.apache.catalina.core.ApplicationFilterChain.internalDoFilter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">ApplicationFilterChain.java:205</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.apache.catalina.core.ApplicationFilterChain.doFilter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">ApplicationFilterChain.java:149</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.apache.tomcat.websocket.server.WsFilter.doFilter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">WsFilter.java:51</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.apache.catalina.core.ApplicationFilterChain.internalDoFilter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">ApplicationFilterChain.java:174</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.apache.catalina.core.ApplicationFilterChain.doFilter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">ApplicationFilterChain.java:149</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.springframework.web.filter.OncePerRequestFilter.doFilter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OncePerRequestFilter.java:110</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.apache.catalina.core.ApplicationFilterChain.internalDoFilter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">ApplicationFilterChain.java:174</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.apache.catalina.core.ApplicationFilterChain.doFilter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">ApplicationFilterChain.java:149</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.springframework.security.web.FilterChainProxy.lambda</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$doFilterInternal$3</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">FilterChainProxy.java:231</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.springframework.security.web.ObservationFilterChainDecorator</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$FilterObservation$SimpleFilterObservation</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">.lambda</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$wrap$1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">ObservationFilterChainDecorator.java:479</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\t……</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>解决方式</p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">yum</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> fontconfig</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -y</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> &#x26;&#x26;</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\"> cd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /usr/share/fonts</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> &#x26;&#x26;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> fc-cache</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">重启应用(jar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)服务</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div>","env":{"base":"/","filePath":"C:/Users/kylinBachelor/Desktop/kylinBachelor.github.io/docs/notes/Docker/制作基础镜像/index.md","filePathRelative":"notes/Docker/制作基础镜像/index.md","frontmatter":{},"sfcBlocks":{"template":{"type":"template","content":"<template><h1 id=\"使用dockerfile制作基础镜像\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#使用dockerfile制作基础镜像\"><span>使用Dockerfile制作基础镜像</span></a></h1>\n<blockquote>\n<p>=== 这里基础镜像使用的时centos:7</p>\n</blockquote>\n<h2 id=\"_1-制作java17的dockerfile\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-制作java17的dockerfile\"><span>1. 制作java17的Dockerfile</span></a></h2>\n<h3 id=\"_1-1-dockerfile文件\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-1-dockerfile文件\"><span>1.1 Dockerfile文件</span></a></h3>\n<div class=\"language-dockerfile line-numbers-mode\" data-ext=\"dockerfile\" data-title=\"dockerfile\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span>FROM centos:7</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span># 配置Java17环境变量</span></span>\n<span class=\"line\"><span>ADD jdk-17_linux-x64_bin.tar.gz /usr/lib/</span></span>\n<span class=\"line\"><span>ENV JAVA_HOME=/usr/lib/jdk-17.0.10</span></span>\n<span class=\"line\"><span>ENV CLASSPATH=.:${JAVA_HOME}/jre/lib/rt.jar:${JAVA_HOME}/lib/dt.jar:${JAVA_HOME}/lib/tools.jar</span></span>\n<span class=\"line\"><span>ENV PATH=$PATH:${JAVA_HOME}/bin</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>CMD /bin/bash</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container warning\">\n<p class=\"hint-container-title\">注意</p>\n<p>jdk17 tar包要跟Dockerfile在同一个目录下，如果tar包使用绝对路径生成镜像的时候会报错</p>\n</div>\n<h3 id=\"_1-2-执行构建命令\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-2-执行构建命令\"><span>1.2 执行构建命令</span></a></h3>\n<blockquote>\n<p>=== 安装包、Dockerfile文件、命令执行 都在同一个目录下</p>\n</blockquote>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> build</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -t</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [镜像名] </span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">.</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 例如</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> build</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -t</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> centos7_jdk17</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> .</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_2-配置镜像\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-配置镜像\"><span>2. 配置镜像</span></a></h2>\n<blockquote>\n<p>=== 进入镜像配置Java环境所必须的一些依赖</p>\n</blockquote>\n<h3 id=\"_2-1-配置yum\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-1-配置yum\"><span>2.1 配置yum</span></a></h3>\n<p>可看阿里云官方的设置方式</p>\n<figure><img src=\"@source/notes/Docker/制作基础镜像/assets/image-20240715135505062.png\" alt=\"image-20240715135505062\" tabindex=\"0\" loading=\"lazy\"><figcaption>image-20240715135505062</figcaption></figure>\n<h4 id=\"_2-1-1-备份自带的yum配置\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-1-1-备份自带的yum配置\"><span>2.1.1 备份自带的yum配置</span></a></h4>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">cd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /etc/yum.conf.d</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">mkdir</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> bak</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">mv</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> *</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">.repo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> bak</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h4 id=\"_2-1-2-设置新的yum源\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-1-2-设置新的yum源\"><span>2.1.2 设置新的yum源</span></a></h4>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">vi</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> Centos-base.repo</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>设置阿里基础镜像源</p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># CentOS-Base.repo</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># The mirror system uses the connecting IP address of the client and the</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># update status of each mirror to pick mirrors that are updated to and</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># geographically close to the client.  You should use this for CentOS updates</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># unless you are manually picking other mirrors.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># If the mirrorlist= does not work for you, as a fall back you can try the </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># remarked out baseurl= line instead.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">base</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">CentOS-8.5.2111</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> Base</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mirrors.aliyun.com</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">baseurl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos-vault/8.5.2111/BaseOS/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$basearch</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.aliyuncs.com/centos-vault/8.5.2111/BaseOS/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.cloud.aliyuncs.com/centos-vault/8.5.2111/BaseOS/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgcheck</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgkey</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-Official</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#additional packages that may be useful</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">extras</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">CentOS-8.5.2111</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> Extras</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mirrors.aliyun.com</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">baseurl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos-vault/8.5.2111/extras/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$basearch</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.aliyuncs.com/centos-vault/8.5.2111/extras/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.cloud.aliyuncs.com/centos-vault/8.5.2111/extras/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgcheck</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgkey</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-Official</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#additional packages that extend functionality of existing packages</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">centosplus</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">CentOS-8.5.2111</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> Plus</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mirrors.aliyun.com</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">baseurl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos-vault/8.5.2111/centosplus/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$basearch</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.aliyuncs.com/centos-vault/8.5.2111/centosplus/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.cloud.aliyuncs.com/centos-vault/8.5.2111/centosplus/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgcheck</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">enabled</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgkey</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-Official</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">PowerTools</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">CentOS-8.5.2111</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> PowerTools</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mirrors.aliyun.com</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">baseurl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos-vault/8.5.2111/PowerTools/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$basearch</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.aliyuncs.com/centos-vault/8.5.2111/PowerTools/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.cloud.aliyuncs.com/centos-vault/8.5.2111/PowerTools/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgcheck</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">enabled</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgkey</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-Official</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">AppStream</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">CentOS-8.5.2111</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> AppStream</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mirrors.aliyun.com</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">baseurl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos-vault/8.5.2111/AppStream/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$basearch</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.aliyuncs.com/centos-vault/8.5.2111/AppStream/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.cloud.aliyuncs.com/centos-vault/8.5.2111/AppStream/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgcheck</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgkey</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-Official</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>使用 <strong>yum list</strong> 测试一下，如果包列表则是成功</p>\n<h2 id=\"_3-配置java运行所需要的依赖\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-配置java运行所需要的依赖\"><span>3. 配置Java运行所需要的依赖</span></a></h2>\n<h3 id=\"_3-1-配置-libfreetype-so-6-库\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-1-配置-libfreetype-so-6-库\"><span>3.1 配置 <strong>libfreetype.so.6</strong> 库</span></a></h3>\n<div class=\"hint-container note\">\n<p class=\"hint-container-title\">注</p>\n<p>libfreetype.so.6是一个在Linux系统中的动态链接库文件，它是由FreeType字体渲染引擎提供的</p>\n<p>功能：</p>\n<ol>\n<li>字体文件支持</li>\n<li>文字渲染</li>\n</ol>\n</div>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 对于Debain的系统，如ubuntu</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> apt-get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> update</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> apt-get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> libfreetype6</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 对于RHEL系统， 如centos, fedora</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> yum</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> freetype</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container note\">\n<p class=\"hint-container-title\">注</p>\n<p>如果未安装则运行Java时报错如下：</p>\n<p>Caused by: java.lang.ExceptionInInitializerError: Exception java.lang.UnsatisfiedLinkError: /usr/lib/jdk-17.0.10/lib/libfontmanager.so: libfreetype.so.6: cannot open shared object file: No such file or directory [in thread &quot;main&quot;]</p>\n</div>\n<h3 id=\"_3-2-配置-字体\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-配置-字体\"><span>3.2 配置 字体</span></a></h3>\n<blockquote>\n<p>=== 如果缺少字体，对于访问验证码时会出现问题</p>\n</blockquote>\n<p>报错如下：</p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">jakarta.servlet.ServletException:</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> Handler</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> dispatch</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> failed:</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> java.lang.InternalError:</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> java.lang.reflect.InvocationTargetException</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.springframework.web.servlet.DispatcherServlet.doDispatch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">DispatcherServlet.java:1096</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.springframework.web.servlet.DispatcherServlet.doService</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">DispatcherServlet.java:974</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.springframework.web.servlet.FrameworkServlet.processRequest</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">FrameworkServlet.java:1011</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.springframework.web.servlet.FrameworkServlet.doGet</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">FrameworkServlet.java:903</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> jakarta.servlet.http.HttpServlet.service</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">HttpServlet.java:564</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.springframework.web.servlet.FrameworkServlet.service</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">FrameworkServlet.java:885</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> jakarta.servlet.http.HttpServlet.service</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">HttpServlet.java:658</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.apache.catalina.core.ApplicationFilterChain.internalDoFilter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">ApplicationFilterChain.java:205</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.apache.catalina.core.ApplicationFilterChain.doFilter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">ApplicationFilterChain.java:149</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.apache.tomcat.websocket.server.WsFilter.doFilter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">WsFilter.java:51</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.apache.catalina.core.ApplicationFilterChain.internalDoFilter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">ApplicationFilterChain.java:174</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.apache.catalina.core.ApplicationFilterChain.doFilter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">ApplicationFilterChain.java:149</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.springframework.web.filter.OncePerRequestFilter.doFilter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OncePerRequestFilter.java:110</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.apache.catalina.core.ApplicationFilterChain.internalDoFilter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">ApplicationFilterChain.java:174</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.apache.catalina.core.ApplicationFilterChain.doFilter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">ApplicationFilterChain.java:149</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.springframework.security.web.FilterChainProxy.lambda</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$doFilterInternal$3</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">FilterChainProxy.java:231</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.springframework.security.web.ObservationFilterChainDecorator</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$FilterObservation$SimpleFilterObservation</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">.lambda</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$wrap$1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">ObservationFilterChainDecorator.java:479</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\t……</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>解决方式</p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">yum</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> fontconfig</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -y</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> &#x26;&#x26;</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\"> cd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /usr/share/fonts</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> &#x26;&#x26;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> fc-cache</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">重启应用(jar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)服务</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></template>","contentStripped":"<h1 id=\"使用dockerfile制作基础镜像\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#使用dockerfile制作基础镜像\"><span>使用Dockerfile制作基础镜像</span></a></h1>\n<blockquote>\n<p>=== 这里基础镜像使用的时centos:7</p>\n</blockquote>\n<h2 id=\"_1-制作java17的dockerfile\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-制作java17的dockerfile\"><span>1. 制作java17的Dockerfile</span></a></h2>\n<h3 id=\"_1-1-dockerfile文件\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-1-dockerfile文件\"><span>1.1 Dockerfile文件</span></a></h3>\n<div class=\"language-dockerfile line-numbers-mode\" data-ext=\"dockerfile\" data-title=\"dockerfile\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span>FROM centos:7</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span># 配置Java17环境变量</span></span>\n<span class=\"line\"><span>ADD jdk-17_linux-x64_bin.tar.gz /usr/lib/</span></span>\n<span class=\"line\"><span>ENV JAVA_HOME=/usr/lib/jdk-17.0.10</span></span>\n<span class=\"line\"><span>ENV CLASSPATH=.:${JAVA_HOME}/jre/lib/rt.jar:${JAVA_HOME}/lib/dt.jar:${JAVA_HOME}/lib/tools.jar</span></span>\n<span class=\"line\"><span>ENV PATH=$PATH:${JAVA_HOME}/bin</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>CMD /bin/bash</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container warning\">\n<p class=\"hint-container-title\">注意</p>\n<p>jdk17 tar包要跟Dockerfile在同一个目录下，如果tar包使用绝对路径生成镜像的时候会报错</p>\n</div>\n<h3 id=\"_1-2-执行构建命令\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-2-执行构建命令\"><span>1.2 执行构建命令</span></a></h3>\n<blockquote>\n<p>=== 安装包、Dockerfile文件、命令执行 都在同一个目录下</p>\n</blockquote>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> build</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -t</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [镜像名] </span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">.</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 例如</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> build</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -t</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> centos7_jdk17</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> .</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_2-配置镜像\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-配置镜像\"><span>2. 配置镜像</span></a></h2>\n<blockquote>\n<p>=== 进入镜像配置Java环境所必须的一些依赖</p>\n</blockquote>\n<h3 id=\"_2-1-配置yum\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-1-配置yum\"><span>2.1 配置yum</span></a></h3>\n<p>可看阿里云官方的设置方式</p>\n<figure><img src=\"@source/notes/Docker/制作基础镜像/assets/image-20240715135505062.png\" alt=\"image-20240715135505062\" tabindex=\"0\" loading=\"lazy\"><figcaption>image-20240715135505062</figcaption></figure>\n<h4 id=\"_2-1-1-备份自带的yum配置\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-1-1-备份自带的yum配置\"><span>2.1.1 备份自带的yum配置</span></a></h4>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">cd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /etc/yum.conf.d</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">mkdir</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> bak</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">mv</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> *</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">.repo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> bak</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h4 id=\"_2-1-2-设置新的yum源\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-1-2-设置新的yum源\"><span>2.1.2 设置新的yum源</span></a></h4>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">vi</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> Centos-base.repo</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>设置阿里基础镜像源</p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># CentOS-Base.repo</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># The mirror system uses the connecting IP address of the client and the</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># update status of each mirror to pick mirrors that are updated to and</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># geographically close to the client.  You should use this for CentOS updates</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># unless you are manually picking other mirrors.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># If the mirrorlist= does not work for you, as a fall back you can try the </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># remarked out baseurl= line instead.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">base</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">CentOS-8.5.2111</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> Base</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mirrors.aliyun.com</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">baseurl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos-vault/8.5.2111/BaseOS/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$basearch</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.aliyuncs.com/centos-vault/8.5.2111/BaseOS/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.cloud.aliyuncs.com/centos-vault/8.5.2111/BaseOS/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgcheck</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgkey</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-Official</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#additional packages that may be useful</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">extras</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">CentOS-8.5.2111</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> Extras</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mirrors.aliyun.com</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">baseurl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos-vault/8.5.2111/extras/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$basearch</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.aliyuncs.com/centos-vault/8.5.2111/extras/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.cloud.aliyuncs.com/centos-vault/8.5.2111/extras/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgcheck</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgkey</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-Official</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#additional packages that extend functionality of existing packages</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">centosplus</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">CentOS-8.5.2111</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> Plus</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mirrors.aliyun.com</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">baseurl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos-vault/8.5.2111/centosplus/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$basearch</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.aliyuncs.com/centos-vault/8.5.2111/centosplus/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.cloud.aliyuncs.com/centos-vault/8.5.2111/centosplus/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgcheck</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">enabled</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgkey</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-Official</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">PowerTools</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">CentOS-8.5.2111</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> PowerTools</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mirrors.aliyun.com</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">baseurl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos-vault/8.5.2111/PowerTools/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$basearch</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.aliyuncs.com/centos-vault/8.5.2111/PowerTools/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.cloud.aliyuncs.com/centos-vault/8.5.2111/PowerTools/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgcheck</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">enabled</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgkey</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-Official</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">AppStream</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">CentOS-8.5.2111</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> AppStream</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> -</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> mirrors.aliyun.com</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">baseurl</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos-vault/8.5.2111/AppStream/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$basearch</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.aliyuncs.com/centos-vault/8.5.2111/AppStream/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">        http://mirrors.cloud.aliyuncs.com/centos-vault/8.5.2111/AppStream/$basearch/os/</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgcheck</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">gpgkey</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-Official</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>使用 <strong>yum list</strong> 测试一下，如果包列表则是成功</p>\n<h2 id=\"_3-配置java运行所需要的依赖\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-配置java运行所需要的依赖\"><span>3. 配置Java运行所需要的依赖</span></a></h2>\n<h3 id=\"_3-1-配置-libfreetype-so-6-库\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-1-配置-libfreetype-so-6-库\"><span>3.1 配置 <strong>libfreetype.so.6</strong> 库</span></a></h3>\n<div class=\"hint-container note\">\n<p class=\"hint-container-title\">注</p>\n<p>libfreetype.so.6是一个在Linux系统中的动态链接库文件，它是由FreeType字体渲染引擎提供的</p>\n<p>功能：</p>\n<ol>\n<li>字体文件支持</li>\n<li>文字渲染</li>\n</ol>\n</div>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 对于Debain的系统，如ubuntu</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> apt-get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> update</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> apt-get</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> libfreetype6</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 对于RHEL系统， 如centos, fedora</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> yum</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> freetype</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><div class=\"hint-container note\">\n<p class=\"hint-container-title\">注</p>\n<p>如果未安装则运行Java时报错如下：</p>\n<p>Caused by: java.lang.ExceptionInInitializerError: Exception java.lang.UnsatisfiedLinkError: /usr/lib/jdk-17.0.10/lib/libfontmanager.so: libfreetype.so.6: cannot open shared object file: No such file or directory [in thread &quot;main&quot;]</p>\n</div>\n<h3 id=\"_3-2-配置-字体\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-2-配置-字体\"><span>3.2 配置 字体</span></a></h3>\n<blockquote>\n<p>=== 如果缺少字体，对于访问验证码时会出现问题</p>\n</blockquote>\n<p>报错如下：</p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">jakarta.servlet.ServletException:</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> Handler</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> dispatch</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> failed:</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> java.lang.InternalError:</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> java.lang.reflect.InvocationTargetException</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.springframework.web.servlet.DispatcherServlet.doDispatch</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">DispatcherServlet.java:1096</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.springframework.web.servlet.DispatcherServlet.doService</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">DispatcherServlet.java:974</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.springframework.web.servlet.FrameworkServlet.processRequest</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">FrameworkServlet.java:1011</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.springframework.web.servlet.FrameworkServlet.doGet</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">FrameworkServlet.java:903</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> jakarta.servlet.http.HttpServlet.service</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">HttpServlet.java:564</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.springframework.web.servlet.FrameworkServlet.service</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">FrameworkServlet.java:885</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> jakarta.servlet.http.HttpServlet.service</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">HttpServlet.java:658</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.apache.catalina.core.ApplicationFilterChain.internalDoFilter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">ApplicationFilterChain.java:205</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.apache.catalina.core.ApplicationFilterChain.doFilter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">ApplicationFilterChain.java:149</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.apache.tomcat.websocket.server.WsFilter.doFilter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">WsFilter.java:51</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.apache.catalina.core.ApplicationFilterChain.internalDoFilter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">ApplicationFilterChain.java:174</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.apache.catalina.core.ApplicationFilterChain.doFilter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">ApplicationFilterChain.java:149</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.springframework.web.filter.OncePerRequestFilter.doFilter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">OncePerRequestFilter.java:110</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.apache.catalina.core.ApplicationFilterChain.internalDoFilter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">ApplicationFilterChain.java:174</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.apache.catalina.core.ApplicationFilterChain.doFilter</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">ApplicationFilterChain.java:149</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.springframework.security.web.FilterChainProxy.lambda</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$doFilterInternal$3</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">FilterChainProxy.java:231</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\tat</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> org.springframework.security.web.ObservationFilterChainDecorator</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$FilterObservation$SimpleFilterObservation</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">.lambda</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$wrap$1</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">(</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">ObservationFilterChainDecorator.java:479</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">\t……</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>解决方式</p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">yum</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> fontconfig</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -y</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> &#x26;&#x26;</span><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\"> cd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /usr/share/fonts</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> &#x26;&#x26;</span><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> fc-cache</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">重启应用(jar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)服务</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div>","tagOpen":"<template>","tagClose":"</template>"},"script":null,"scriptSetup":null,"scripts":[],"styles":[],"customBlocks":[]},"content":"\n# 使用Dockerfile制作基础镜像\r\n\r\n> === 这里基础镜像使用的时centos:7\r\n\r\n## 1. 制作java17的Dockerfile\r\n\r\n### 1.1 Dockerfile文件\r\n\r\n```dockerfile\r\nFROM centos:7\r\n\r\n# 配置Java17环境变量\r\nADD jdk-17_linux-x64_bin.tar.gz /usr/lib/\r\nENV JAVA_HOME=/usr/lib/jdk-17.0.10\r\nENV CLASSPATH=.:${JAVA_HOME}/jre/lib/rt.jar:${JAVA_HOME}/lib/dt.jar:${JAVA_HOME}/lib/tools.jar\r\nENV PATH=$PATH:${JAVA_HOME}/bin\r\n\r\nCMD /bin/bash\r\n```\r\n\r\n> [!warning]\r\n>\r\n> jdk17 tar包要跟Dockerfile在同一个目录下，如果tar包使用绝对路径生成镜像的时候会报错\r\n\r\n### 1.2 执行构建命令\r\n\r\n> === 安装包、Dockerfile文件、命令执行 都在同一个目录下\r\n\r\n```sh\r\ndocker build -t [镜像名] .\r\n\r\n# 例如\r\ndocker build -t centos7_jdk17 .\r\n```\r\n\r\n## 2. 配置镜像\r\n\r\n> === 进入镜像配置Java环境所必须的一些依赖\r\n\r\n### 2.1 配置yum\r\n\r\n可看阿里云官方的设置方式\r\n\r\n![image-20240715135505062](./assets/image-20240715135505062.png)\r\n\r\n#### 2.1.1 备份自带的yum配置\r\n\r\n```sh\r\ncd /etc/yum.conf.d\r\n\r\nmkdir bak\r\n\r\nmv *.repo bak\r\n```\r\n\r\n\r\n\r\n#### 2.1.2 设置新的yum源\r\n\r\n```sh\r\nvi Centos-base.repo\r\n```\r\n\r\n设置阿里基础镜像源\r\n\r\n```sh\r\n# CentOS-Base.repo\r\n#\r\n# The mirror system uses the connecting IP address of the client and the\r\n# update status of each mirror to pick mirrors that are updated to and\r\n# geographically close to the client.  You should use this for CentOS updates\r\n# unless you are manually picking other mirrors.\r\n#\r\n# If the mirrorlist= does not work for you, as a fall back you can try the \r\n# remarked out baseurl= line instead.\r\n#\r\n#\r\n \r\n[base]\r\nname=CentOS-8.5.2111 - Base - mirrors.aliyun.com\r\nbaseurl=http://mirrors.aliyun.com/centos-vault/8.5.2111/BaseOS/$basearch/os/\r\n        http://mirrors.aliyuncs.com/centos-vault/8.5.2111/BaseOS/$basearch/os/\r\n        http://mirrors.cloud.aliyuncs.com/centos-vault/8.5.2111/BaseOS/$basearch/os/\r\ngpgcheck=0\r\ngpgkey=http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-Official\r\n \r\n#additional packages that may be useful\r\n[extras]\r\nname=CentOS-8.5.2111 - Extras - mirrors.aliyun.com\r\nbaseurl=http://mirrors.aliyun.com/centos-vault/8.5.2111/extras/$basearch/os/\r\n        http://mirrors.aliyuncs.com/centos-vault/8.5.2111/extras/$basearch/os/\r\n        http://mirrors.cloud.aliyuncs.com/centos-vault/8.5.2111/extras/$basearch/os/\r\ngpgcheck=0\r\ngpgkey=http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-Official\r\n \r\n#additional packages that extend functionality of existing packages\r\n[centosplus]\r\nname=CentOS-8.5.2111 - Plus - mirrors.aliyun.com\r\nbaseurl=http://mirrors.aliyun.com/centos-vault/8.5.2111/centosplus/$basearch/os/\r\n        http://mirrors.aliyuncs.com/centos-vault/8.5.2111/centosplus/$basearch/os/\r\n        http://mirrors.cloud.aliyuncs.com/centos-vault/8.5.2111/centosplus/$basearch/os/\r\ngpgcheck=0\r\nenabled=0\r\ngpgkey=http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-Official\r\n \r\n[PowerTools]\r\nname=CentOS-8.5.2111 - PowerTools - mirrors.aliyun.com\r\nbaseurl=http://mirrors.aliyun.com/centos-vault/8.5.2111/PowerTools/$basearch/os/\r\n        http://mirrors.aliyuncs.com/centos-vault/8.5.2111/PowerTools/$basearch/os/\r\n        http://mirrors.cloud.aliyuncs.com/centos-vault/8.5.2111/PowerTools/$basearch/os/\r\ngpgcheck=0\r\nenabled=0\r\ngpgkey=http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-Official\r\n\r\n\r\n[AppStream]\r\nname=CentOS-8.5.2111 - AppStream - mirrors.aliyun.com\r\nbaseurl=http://mirrors.aliyun.com/centos-vault/8.5.2111/AppStream/$basearch/os/\r\n        http://mirrors.aliyuncs.com/centos-vault/8.5.2111/AppStream/$basearch/os/\r\n        http://mirrors.cloud.aliyuncs.com/centos-vault/8.5.2111/AppStream/$basearch/os/\r\ngpgcheck=0\r\ngpgkey=http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-Official\r\n\r\n```\r\n\r\n使用 **yum list** 测试一下，如果包列表则是成功\r\n\r\n\r\n\r\n## 3. 配置Java运行所需要的依赖\r\n\r\n### 3.1 配置 **libfreetype.so.6** 库\r\n\r\n> [!note]\r\n>\r\n> libfreetype.so.6是一个在Linux系统中的动态链接库文件，它是由FreeType字体渲染引擎提供的\r\n>\r\n> 功能：\r\n>\r\n> 1. 字体文件支持\r\n> 2. 文字渲染\r\n\r\n```sh\r\n# 对于Debain的系统，如ubuntu\r\nsudo apt-get update\r\nsudo apt-get install libfreetype6\r\n\r\n# 对于RHEL系统， 如centos, fedora\r\nsudo yum install freetype\r\n```\r\n\r\n> [!note]\r\n>\r\n> 如果未安装则运行Java时报错如下：\r\n>\r\n> Caused by: java.lang.ExceptionInInitializerError: Exception java.lang.UnsatisfiedLinkError: /usr/lib/jdk-17.0.10/lib/libfontmanager.so: libfreetype.so.6: cannot open shared object file: No such file or directory [in thread \"main\"]\r\n\r\n\r\n\r\n### 3.2 配置 字体\r\n\r\n> === 如果缺少字体，对于访问验证码时会出现问题\r\n\r\n报错如下：\r\n\r\n```sh\r\njakarta.servlet.ServletException: Handler dispatch failed: java.lang.InternalError: java.lang.reflect.InvocationTargetException\r\n\tat org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1096)\r\n\tat org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:974)\r\n\tat org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1011)\r\n\tat org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)\r\n\tat jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)\r\n\tat org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)\r\n\tat jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)\r\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)\r\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)\r\n\tat org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)\r\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)\r\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)\r\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:110)\r\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)\r\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)\r\n\tat org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231)\r\n\tat org.springframework.security.web.ObservationFilterChainDecorator$FilterObservation$SimpleFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:479)\r\n\t……\r\n```\r\n\r\n解决方式\r\n\r\n```sh\r\nyum install fontconfig -y && cd /usr/share/fonts && fc-cache\r\n\r\n重启应用(jar)服务\r\n```","excerpt":"","includedFiles":[],"tasklists":0,"title":"使用Dockerfile制作基础镜像","headers":[{"level":2,"title":"1. 制作java17的Dockerfile","slug":"_1-制作java17的dockerfile","link":"#_1-制作java17的dockerfile","children":[{"level":3,"title":"1.1 Dockerfile文件","slug":"_1-1-dockerfile文件","link":"#_1-1-dockerfile文件","children":[]},{"level":3,"title":"1.2 执行构建命令","slug":"_1-2-执行构建命令","link":"#_1-2-执行构建命令","children":[]}]},{"level":2,"title":"2. 配置镜像","slug":"_2-配置镜像","link":"#_2-配置镜像","children":[{"level":3,"title":"2.1 配置yum","slug":"_2-1-配置yum","link":"#_2-1-配置yum","children":[]}]},{"level":2,"title":"3. 配置Java运行所需要的依赖","slug":"_3-配置java运行所需要的依赖","link":"#_3-配置java运行所需要的依赖","children":[{"level":3,"title":"3.1 配置 libfreetype.so.6 库","slug":"_3-1-配置-libfreetype-so-6-库","link":"#_3-1-配置-libfreetype-so-6-库","children":[]},{"level":3,"title":"3.2 配置 字体","slug":"_3-2-配置-字体","link":"#_3-2-配置-字体","children":[]}]}]}}
