{"content":"<h1 id=\"centos下安装elasticsearch记录\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#centos下安装elasticsearch记录\"><span>Centos下安装Elasticsearch记录</span></a></h1>\n<h2 id=\"_1-下载es\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-下载es\"><span>1. 下载ES</span></a></h2>\n<p>下载地址：https://www.elastic.co/cn/downloads/past-releases</p>\n<p>相应的版本对应相应地址规则，例如：https://www.elastic.co/cn/downloads/past-releases/elasticsearch-7-8-0</p>\n<p>如图：</p>\n<p><img src=\"@source/notes/Elasticsearch/Centos下安装ES/assets/image-20241012101124866.png\" alt=\"image-20241012101124866\"></p>\n<p>ES版本和jdk版本对应关系：https://www.elastic.co/cn/support/matrix#matrix_jvm</p>\n<div class=\"hint-container warning\">\n<p class=\"hint-container-title\">注意</p>\n<p>需要下载和Linux系统架构一致的ES安装包</p>\n</div>\n<h2 id=\"_2-解压tar包并放在安装的目录\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-解压tar包并放在安装的目录\"><span>2. 解压tar包并放在安装的目录</span></a></h2>\n<h2 id=\"_3-创建linux用户\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-创建linux用户\"><span>3. 创建Linux用户</span></a></h2>\n<p>在es中<code v-pre>超级管理员</code>用户是不允许操作es的，因此需要添加其他用户来操作es</p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">useradd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> es</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> #新增 es 用户</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">passwd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> es</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> #为 es 用户设置密码</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">userdel</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -r</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> es</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> #如果错了，可以删除再加</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">chown</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -R</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> es:es</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /opt/module/es</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> #文件夹所有者,即给es用户设置可操作的目录权限</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_4-jdk设置\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_4-jdk设置\"><span>4. JDK设置</span></a></h2>\n<p>ES的启动需要jdk环境，默认情况下，如果Linux系统中安装了Java环境，ES会直接去找系统的jdk。</p>\n<p>ES自己也带有jdk，默认情况下，如果Linux系统中没有Java环境，ES会使用自己的jdk。</p>\n<div class=\"hint-container note\">\n<p class=\"hint-container-title\">注</p>\n<p>建议在启动ES时使用ES自己的jdk，因为ES版本和jdk版本是有关联的，正常情况下，Linux系统级的jdk版本是不可修改的，不能因为要使用ES就修改系统级的jdk版本。</p>\n</div>\n<h2 id=\"_5-设置es使用es自己的jdk\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_5-设置es使用es自己的jdk\"><span>5. 设置ES使用ES自己的jdk</span></a></h2>\n<p>个人尝试了三个ES版本：<code v-pre>8.15.1</code>,<code v-pre>8.15.2</code>,<code v-pre>7.17.18</code></p>\n<h3 id=\"_5-1-8-x版本\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_5-1-8-x版本\"><span>5.1  <code v-pre>8.x版本</code></span></a></h3>\n<p>对应 <code v-pre>8.15.1</code>,<code v-pre>8.15.2</code> 版本或者说 <code v-pre>8.x</code>版本（8.x其他版本没试，只是猜测）的变化不大，设置方式如下：</p>\n<p>进入到es安装包目录的<code v-pre>bin</code> 目录下找到<code v-pre>elasticsearch</code> 文件</p>\n<p><img src=\"@source/notes/Elasticsearch/Centos下安装ES/assets/image-20241012103528908-1728700535391-2.png\" alt=\"image-20241012103528908\"></p>\n<p>编辑文件 <code v-pre>vim elasticsearch</code>，设置ES自己的jdk环境，<code v-pre>一定要把设置放在最下边</code></p>\n<p><img src=\"@source/notes/Elasticsearch/Centos下安装ES/assets/image-20241012103628927.png\" alt=\"image-20241012103628927\"></p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># JAVA_HOME 目录需要改成自己的es的jdk目录</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">export</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> JAVA_HOME</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">home</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">soft</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">elasticsearch-8</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">15</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">jdk</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">export</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> PATH</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$JAVA_HOME</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">bin</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">:</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$PATH</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">export</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> CLASSPATH</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.:</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$JAVA_HOME</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">lib</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">dt</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">jar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">:</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$JAVA_HOME</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">lib</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">tool</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">jar</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_5-2-对于7-17-18-版本\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_5-2-对于7-17-18-版本\"><span>5.2  对于<code v-pre>7.17.18</code> 版本</span></a></h3>\n<p><code v-pre>7.17.18</code>版本的<code v-pre>elasticsearch</code>文件和<code v-pre>8.15.x</code>版本的<code v-pre>elasticsearch</code>文件差别很大，我也没做研究</p>\n<p>我的环境是jdk17,没有修改jdk就可以，所以这里就不赘述了</p>\n<h2 id=\"_6-设置参数配置\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_6-设置参数配置\"><span>6. 设置参数配置</span></a></h2>\n<h3 id=\"_6-1-设置es配置文件-elasticsearch-yml\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_6-1-设置es配置文件-elasticsearch-yml\"><span>6.1 设置ES配置文件(elasticsearch.yml)</span></a></h3>\n<p>位置：<code v-pre>ES包/config/elasticsearch.yml</code></p>\n<p>内容如下：</p>\n<div class=\"language-yaml line-numbers-mode\" data-ext=\"yaml\" data-title=\"yaml\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ======================== Elasticsearch Configuration =========================</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># NOTE: Elasticsearch comes with reasonable defaults for most settings.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#       Before you set out to tweak and tune the configuration, make sure you</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#       understand what are you trying to accomplish and the consequences.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># The primary way of configuring a node is via this file. This template lists</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># the most important settings you may want to configure for a production cluster.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Please consult the documentation for further information on configuration options:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># https://www.elastic.co/guide/en/elasticsearch/reference/index.html</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ---------------------------------- Cluster -----------------------------------</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Use a descriptive name for your cluster:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 集群名称</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">cluster.name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> elasticsearch</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ------------------------------------ Node ------------------------------------</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Use a descriptive name for the node:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 节点名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">node.name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> node-1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Add custom attributes to the node:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#node.attr.rack: r1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ----------------------------------- Paths ------------------------------------</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Path to directory where to store the data (separate multiple locations by comma):</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 数据存放位置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">path.data</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">  /home/soft/elasticsearch-7.17.18/data</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Path to log files:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 日志存放位置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">path.logs</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /home/soft/elasticsearch-7.17.18/logs</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ----------------------------------- Memory -----------------------------------</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Lock the memory on startup:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#bootstrap.memory_lock: true</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Make sure that the heap size is set to about half the memory available</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># on the system and that the owner of the process is allowed to use this</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># limit.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Elasticsearch performs poorly when the system is swapping the memory.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ---------------------------------- Network -----------------------------------</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># By default Elasticsearch is only accessible on localhost. Set a different</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># address here to expose this node on the network:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 设置所有机器都可以访问</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">network.host</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0.0.0.0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># By default Elasticsearch listens for HTTP traffic on the first free port it</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># finds starting at 9200. Set a specific HTTP port here:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 设置端口</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">http.port</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 9200</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># For more information, consult the network module documentation.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># --------------------------------- Discovery ----------------------------------</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Pass an initial list of hosts to perform discovery when this node is started:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># The default list of hosts is [\"127.0.0.1\", \"[::1]\"]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#discovery.seed_hosts: [\"host1\", \"host2\"]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Bootstrap the cluster using an initial set of master-eligible nodes:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">cluster.initial_master_nodes</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> [</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">node-1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># For more information, consult the discovery and cluster formation module documentation.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ---------------------------------- Various -----------------------------------</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Require explicit names when deleting indices:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#action.destructive_requires_name: true</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ---------------------------------- Security ----------------------------------</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#                                 *** WARNING ***</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Elasticsearch security features are not enabled by default.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># These features are free, but require configuration changes to enable them.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># This means that users don’t have to provide credentials and can get full access</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># to the cluster. Network connections are also not encrypted.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># To protect your data, we strongly encourage you to enable the Elasticsearch security features. </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Refer to the following documentation for instructions.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># https://www.elastic.co/guide/en/elasticsearch/reference/7.16/configuring-stack-security.html</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 开启es跨域</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">http.cors.enabled</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> true</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">http.cors.allow-origin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">*</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">http.cors.allow-headers</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> Authorization</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># # # 开启安全控制</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">xpack.security.enabled</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> true</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">xpack.security.transport.ssl.enabled</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> true</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_6-2-修改jvm启动参数\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_6-2-修改jvm启动参数\"><span>6.2 修改jvm启动参数</span></a></h3>\n<p>防止撑满内存</p>\n<p>位置：<code v-pre>es包/config/jvm.options</code></p>\n<p><img src=\"@source/notes/Elasticsearch/Centos下安装ES/assets/image-20241012110731047.png\" alt=\"image-20241012110731047\"></p>\n<h3 id=\"_6-3-修改-etc-security-limits-conf\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_6-3-修改-etc-security-limits-conf\"><span>6.3 修改/etc/security/limits.conf</span></a></h3>\n<p>vim /etc/security/limits.conf</p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 在文件末尾中增加下面内容</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 每个进程可以打开的文件数的限制</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">es</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> soft</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> nofile</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 65536</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">es</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> hard</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> nofile</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 65536</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_6-4-修改-etc-security-limits-d-20-nproc-conf\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_6-4-修改-etc-security-limits-d-20-nproc-conf\"><span>6.4 修改/etc/security/limits.d/20-nproc.conf</span></a></h3>\n<p>vim /etc/security/limits.d/20-nproc.conf</p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 在文件末尾中增加下面内容</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 每个进程可以打开的文件数的限制</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">es</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> soft</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> nofile</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 65536</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">es</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> hard</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> nofile</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 65536</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 操作系统级别对每个用户创建的进程数的限制</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">*</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> hard nproc 4096</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 注： * 带表 Linux 所有用户名称</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_6-5-修改-etc-sysctl-conf\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_6-5-修改-etc-sysctl-conf\"><span>6.5 修改/etc/sysctl.conf</span></a></h3>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 在文件中增加下面内容</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 一个进程可以拥有的 VMA(虚拟内存区域)的数量,默认值为 65536</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">vm.max_map_count</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">=655360</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_6-6-重新加载或重启linux系统\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_6-6-重新加载或重启linux系统\"><span>6.6 重新加载或重启Linux系统</span></a></h3>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">sysctl</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -p</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h2 id=\"_7-启动\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_7-启动\"><span>7. 启动</span></a></h2>\n<p>进入：<code v-pre>es包/bin</code></p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 切换到上面添加的es用户</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">su</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> es</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 非后台启动，关闭命令行则es关闭,建议安装测试阶段使用该方式，也容易查看报错记录</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">./elasticsearch</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 后台启动</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">./elasticsearch</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -d</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_8-设置或修改-es密码\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_8-设置或修改-es密码\"><span>8. 设置或修改 ES密码</span></a></h2>\n<p>进入 <code v-pre>es包/bin</code></p>\n<p>7.x版本和8.x版本有些不同，7.x版本没有设置密码只有重置密码</p>\n<p>7.x</p>\n<p><img src=\"@source/notes/Elasticsearch/Centos下安装ES/assets/image-20241012111552636.png\" alt=\"image-20241012111552636\"></p>\n<p>8.x</p>\n<p><img src=\"@source/notes/Elasticsearch/Centos下安装ES/assets/image-20241012111620565.png\" alt=\"image-20241012111620565\"></p>\n<p>设置密码方式：</p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 设置密码</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> ./elasticsearch-setup-passwords</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> interactive</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 重置密码</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> ./elasticsearch-reset-passwords</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> interactive</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_9-访问测试是否成功\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_9-访问测试是否成功\"><span>9. 访问测试是否成功</span></a></h2>\n<p>使用默认的9200（上面配置文件设置的端口）端口访问，如下则表示启动成功</p>\n<p><img src=\"@source/notes/Elasticsearch/Centos下安装ES/assets/image-20241012112000741.png\" alt=\"image-20241012112000741\"></p>\n<h2 id=\"_10-安装插件\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_10-安装插件\"><span>10. 安装插件</span></a></h2>\n<div class=\"hint-container warning\">\n<p class=\"hint-container-title\">注意</p>\n<p>ES插件需要和ES版本号相对应</p>\n</div>\n<p>拼音插件地址：https://github.com/infinilabs/analysis-pinyin/releases\n分词插件地址：https://github.com/infinilabs/analysis-ik/releases</p>\n<p>下载这个zip</p>\n<p><img src=\"@source/notes/Elasticsearch/Centos下安装ES/assets/image-20241012114257117.png\" alt=\"image-20241012114257117\"></p>\n<p>然后解压放到 <code v-pre>es包/plugins</code>下，重启es即可</p>\n<p><img src=\"@source/notes/Elasticsearch/Centos下安装ES/assets/image-20241012114401042.png\" alt=\"image-20241012114401042\"></p>\n","env":{"base":"/","filePath":"C:/Users/kylinBachelor/Desktop/kylinBachelor.github.io/docs/notes/Elasticsearch/Centos下安装ES/index.md","filePathRelative":"notes/Elasticsearch/Centos下安装ES/index.md","frontmatter":{},"sfcBlocks":{"template":{"type":"template","content":"<template><h1 id=\"centos下安装elasticsearch记录\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#centos下安装elasticsearch记录\"><span>Centos下安装Elasticsearch记录</span></a></h1>\n<h2 id=\"_1-下载es\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-下载es\"><span>1. 下载ES</span></a></h2>\n<p>下载地址：https://www.elastic.co/cn/downloads/past-releases</p>\n<p>相应的版本对应相应地址规则，例如：https://www.elastic.co/cn/downloads/past-releases/elasticsearch-7-8-0</p>\n<p>如图：</p>\n<p><img src=\"@source/notes/Elasticsearch/Centos下安装ES/assets/image-20241012101124866.png\" alt=\"image-20241012101124866\"></p>\n<p>ES版本和jdk版本对应关系：https://www.elastic.co/cn/support/matrix#matrix_jvm</p>\n<div class=\"hint-container warning\">\n<p class=\"hint-container-title\">注意</p>\n<p>需要下载和Linux系统架构一致的ES安装包</p>\n</div>\n<h2 id=\"_2-解压tar包并放在安装的目录\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-解压tar包并放在安装的目录\"><span>2. 解压tar包并放在安装的目录</span></a></h2>\n<h2 id=\"_3-创建linux用户\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-创建linux用户\"><span>3. 创建Linux用户</span></a></h2>\n<p>在es中<code v-pre>超级管理员</code>用户是不允许操作es的，因此需要添加其他用户来操作es</p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">useradd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> es</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> #新增 es 用户</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">passwd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> es</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> #为 es 用户设置密码</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">userdel</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -r</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> es</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> #如果错了，可以删除再加</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">chown</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -R</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> es:es</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /opt/module/es</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> #文件夹所有者,即给es用户设置可操作的目录权限</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_4-jdk设置\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_4-jdk设置\"><span>4. JDK设置</span></a></h2>\n<p>ES的启动需要jdk环境，默认情况下，如果Linux系统中安装了Java环境，ES会直接去找系统的jdk。</p>\n<p>ES自己也带有jdk，默认情况下，如果Linux系统中没有Java环境，ES会使用自己的jdk。</p>\n<div class=\"hint-container note\">\n<p class=\"hint-container-title\">注</p>\n<p>建议在启动ES时使用ES自己的jdk，因为ES版本和jdk版本是有关联的，正常情况下，Linux系统级的jdk版本是不可修改的，不能因为要使用ES就修改系统级的jdk版本。</p>\n</div>\n<h2 id=\"_5-设置es使用es自己的jdk\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_5-设置es使用es自己的jdk\"><span>5. 设置ES使用ES自己的jdk</span></a></h2>\n<p>个人尝试了三个ES版本：<code v-pre>8.15.1</code>,<code v-pre>8.15.2</code>,<code v-pre>7.17.18</code></p>\n<h3 id=\"_5-1-8-x版本\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_5-1-8-x版本\"><span>5.1  <code v-pre>8.x版本</code></span></a></h3>\n<p>对应 <code v-pre>8.15.1</code>,<code v-pre>8.15.2</code> 版本或者说 <code v-pre>8.x</code>版本（8.x其他版本没试，只是猜测）的变化不大，设置方式如下：</p>\n<p>进入到es安装包目录的<code v-pre>bin</code> 目录下找到<code v-pre>elasticsearch</code> 文件</p>\n<p><img src=\"@source/notes/Elasticsearch/Centos下安装ES/assets/image-20241012103528908-1728700535391-2.png\" alt=\"image-20241012103528908\"></p>\n<p>编辑文件 <code v-pre>vim elasticsearch</code>，设置ES自己的jdk环境，<code v-pre>一定要把设置放在最下边</code></p>\n<p><img src=\"@source/notes/Elasticsearch/Centos下安装ES/assets/image-20241012103628927.png\" alt=\"image-20241012103628927\"></p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># JAVA_HOME 目录需要改成自己的es的jdk目录</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">export</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> JAVA_HOME</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">home</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">soft</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">elasticsearch-8</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">15</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">jdk</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">export</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> PATH</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$JAVA_HOME</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">bin</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">:</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$PATH</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">export</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> CLASSPATH</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.:</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$JAVA_HOME</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">lib</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">dt</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">jar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">:</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$JAVA_HOME</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">lib</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">tool</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">jar</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_5-2-对于7-17-18-版本\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_5-2-对于7-17-18-版本\"><span>5.2  对于<code v-pre>7.17.18</code> 版本</span></a></h3>\n<p><code v-pre>7.17.18</code>版本的<code v-pre>elasticsearch</code>文件和<code v-pre>8.15.x</code>版本的<code v-pre>elasticsearch</code>文件差别很大，我也没做研究</p>\n<p>我的环境是jdk17,没有修改jdk就可以，所以这里就不赘述了</p>\n<h2 id=\"_6-设置参数配置\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_6-设置参数配置\"><span>6. 设置参数配置</span></a></h2>\n<h3 id=\"_6-1-设置es配置文件-elasticsearch-yml\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_6-1-设置es配置文件-elasticsearch-yml\"><span>6.1 设置ES配置文件(elasticsearch.yml)</span></a></h3>\n<p>位置：<code v-pre>ES包/config/elasticsearch.yml</code></p>\n<p>内容如下：</p>\n<div class=\"language-yaml line-numbers-mode\" data-ext=\"yaml\" data-title=\"yaml\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ======================== Elasticsearch Configuration =========================</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># NOTE: Elasticsearch comes with reasonable defaults for most settings.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#       Before you set out to tweak and tune the configuration, make sure you</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#       understand what are you trying to accomplish and the consequences.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># The primary way of configuring a node is via this file. This template lists</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># the most important settings you may want to configure for a production cluster.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Please consult the documentation for further information on configuration options:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># https://www.elastic.co/guide/en/elasticsearch/reference/index.html</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ---------------------------------- Cluster -----------------------------------</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Use a descriptive name for your cluster:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 集群名称</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">cluster.name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> elasticsearch</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ------------------------------------ Node ------------------------------------</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Use a descriptive name for the node:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 节点名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">node.name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> node-1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Add custom attributes to the node:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#node.attr.rack: r1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ----------------------------------- Paths ------------------------------------</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Path to directory where to store the data (separate multiple locations by comma):</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 数据存放位置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">path.data</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">  /home/soft/elasticsearch-7.17.18/data</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Path to log files:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 日志存放位置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">path.logs</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /home/soft/elasticsearch-7.17.18/logs</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ----------------------------------- Memory -----------------------------------</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Lock the memory on startup:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#bootstrap.memory_lock: true</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Make sure that the heap size is set to about half the memory available</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># on the system and that the owner of the process is allowed to use this</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># limit.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Elasticsearch performs poorly when the system is swapping the memory.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ---------------------------------- Network -----------------------------------</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># By default Elasticsearch is only accessible on localhost. Set a different</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># address here to expose this node on the network:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 设置所有机器都可以访问</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">network.host</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0.0.0.0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># By default Elasticsearch listens for HTTP traffic on the first free port it</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># finds starting at 9200. Set a specific HTTP port here:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 设置端口</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">http.port</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 9200</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># For more information, consult the network module documentation.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># --------------------------------- Discovery ----------------------------------</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Pass an initial list of hosts to perform discovery when this node is started:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># The default list of hosts is [\"127.0.0.1\", \"[::1]\"]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#discovery.seed_hosts: [\"host1\", \"host2\"]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Bootstrap the cluster using an initial set of master-eligible nodes:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">cluster.initial_master_nodes</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> [</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">node-1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># For more information, consult the discovery and cluster formation module documentation.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ---------------------------------- Various -----------------------------------</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Require explicit names when deleting indices:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#action.destructive_requires_name: true</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ---------------------------------- Security ----------------------------------</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#                                 *** WARNING ***</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Elasticsearch security features are not enabled by default.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># These features are free, but require configuration changes to enable them.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># This means that users don’t have to provide credentials and can get full access</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># to the cluster. Network connections are also not encrypted.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># To protect your data, we strongly encourage you to enable the Elasticsearch security features. </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Refer to the following documentation for instructions.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># https://www.elastic.co/guide/en/elasticsearch/reference/7.16/configuring-stack-security.html</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 开启es跨域</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">http.cors.enabled</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> true</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">http.cors.allow-origin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">*</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">http.cors.allow-headers</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> Authorization</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># # # 开启安全控制</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">xpack.security.enabled</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> true</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">xpack.security.transport.ssl.enabled</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> true</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_6-2-修改jvm启动参数\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_6-2-修改jvm启动参数\"><span>6.2 修改jvm启动参数</span></a></h3>\n<p>防止撑满内存</p>\n<p>位置：<code v-pre>es包/config/jvm.options</code></p>\n<p><img src=\"@source/notes/Elasticsearch/Centos下安装ES/assets/image-20241012110731047.png\" alt=\"image-20241012110731047\"></p>\n<h3 id=\"_6-3-修改-etc-security-limits-conf\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_6-3-修改-etc-security-limits-conf\"><span>6.3 修改/etc/security/limits.conf</span></a></h3>\n<p>vim /etc/security/limits.conf</p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 在文件末尾中增加下面内容</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 每个进程可以打开的文件数的限制</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">es</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> soft</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> nofile</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 65536</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">es</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> hard</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> nofile</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 65536</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_6-4-修改-etc-security-limits-d-20-nproc-conf\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_6-4-修改-etc-security-limits-d-20-nproc-conf\"><span>6.4 修改/etc/security/limits.d/20-nproc.conf</span></a></h3>\n<p>vim /etc/security/limits.d/20-nproc.conf</p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 在文件末尾中增加下面内容</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 每个进程可以打开的文件数的限制</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">es</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> soft</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> nofile</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 65536</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">es</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> hard</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> nofile</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 65536</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 操作系统级别对每个用户创建的进程数的限制</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">*</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> hard nproc 4096</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 注： * 带表 Linux 所有用户名称</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_6-5-修改-etc-sysctl-conf\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_6-5-修改-etc-sysctl-conf\"><span>6.5 修改/etc/sysctl.conf</span></a></h3>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 在文件中增加下面内容</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 一个进程可以拥有的 VMA(虚拟内存区域)的数量,默认值为 65536</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">vm.max_map_count</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">=655360</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_6-6-重新加载或重启linux系统\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_6-6-重新加载或重启linux系统\"><span>6.6 重新加载或重启Linux系统</span></a></h3>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">sysctl</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -p</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h2 id=\"_7-启动\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_7-启动\"><span>7. 启动</span></a></h2>\n<p>进入：<code v-pre>es包/bin</code></p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 切换到上面添加的es用户</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">su</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> es</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 非后台启动，关闭命令行则es关闭,建议安装测试阶段使用该方式，也容易查看报错记录</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">./elasticsearch</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 后台启动</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">./elasticsearch</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -d</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_8-设置或修改-es密码\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_8-设置或修改-es密码\"><span>8. 设置或修改 ES密码</span></a></h2>\n<p>进入 <code v-pre>es包/bin</code></p>\n<p>7.x版本和8.x版本有些不同，7.x版本没有设置密码只有重置密码</p>\n<p>7.x</p>\n<p><img src=\"@source/notes/Elasticsearch/Centos下安装ES/assets/image-20241012111552636.png\" alt=\"image-20241012111552636\"></p>\n<p>8.x</p>\n<p><img src=\"@source/notes/Elasticsearch/Centos下安装ES/assets/image-20241012111620565.png\" alt=\"image-20241012111620565\"></p>\n<p>设置密码方式：</p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 设置密码</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> ./elasticsearch-setup-passwords</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> interactive</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 重置密码</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> ./elasticsearch-reset-passwords</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> interactive</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_9-访问测试是否成功\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_9-访问测试是否成功\"><span>9. 访问测试是否成功</span></a></h2>\n<p>使用默认的9200（上面配置文件设置的端口）端口访问，如下则表示启动成功</p>\n<p><img src=\"@source/notes/Elasticsearch/Centos下安装ES/assets/image-20241012112000741.png\" alt=\"image-20241012112000741\"></p>\n<h2 id=\"_10-安装插件\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_10-安装插件\"><span>10. 安装插件</span></a></h2>\n<div class=\"hint-container warning\">\n<p class=\"hint-container-title\">注意</p>\n<p>ES插件需要和ES版本号相对应</p>\n</div>\n<p>拼音插件地址：https://github.com/infinilabs/analysis-pinyin/releases\n分词插件地址：https://github.com/infinilabs/analysis-ik/releases</p>\n<p>下载这个zip</p>\n<p><img src=\"@source/notes/Elasticsearch/Centos下安装ES/assets/image-20241012114257117.png\" alt=\"image-20241012114257117\"></p>\n<p>然后解压放到 <code v-pre>es包/plugins</code>下，重启es即可</p>\n<p><img src=\"@source/notes/Elasticsearch/Centos下安装ES/assets/image-20241012114401042.png\" alt=\"image-20241012114401042\"></p>\n</template>","contentStripped":"<h1 id=\"centos下安装elasticsearch记录\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#centos下安装elasticsearch记录\"><span>Centos下安装Elasticsearch记录</span></a></h1>\n<h2 id=\"_1-下载es\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-下载es\"><span>1. 下载ES</span></a></h2>\n<p>下载地址：https://www.elastic.co/cn/downloads/past-releases</p>\n<p>相应的版本对应相应地址规则，例如：https://www.elastic.co/cn/downloads/past-releases/elasticsearch-7-8-0</p>\n<p>如图：</p>\n<p><img src=\"@source/notes/Elasticsearch/Centos下安装ES/assets/image-20241012101124866.png\" alt=\"image-20241012101124866\"></p>\n<p>ES版本和jdk版本对应关系：https://www.elastic.co/cn/support/matrix#matrix_jvm</p>\n<div class=\"hint-container warning\">\n<p class=\"hint-container-title\">注意</p>\n<p>需要下载和Linux系统架构一致的ES安装包</p>\n</div>\n<h2 id=\"_2-解压tar包并放在安装的目录\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-解压tar包并放在安装的目录\"><span>2. 解压tar包并放在安装的目录</span></a></h2>\n<h2 id=\"_3-创建linux用户\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-创建linux用户\"><span>3. 创建Linux用户</span></a></h2>\n<p>在es中<code v-pre>超级管理员</code>用户是不允许操作es的，因此需要添加其他用户来操作es</p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">useradd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> es</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> #新增 es 用户</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">passwd</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> es</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> #为 es 用户设置密码</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">userdel</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -r</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> es</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> #如果错了，可以删除再加</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">chown</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -R</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> es:es</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /opt/module/es</span><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"> #文件夹所有者,即给es用户设置可操作的目录权限</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_4-jdk设置\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_4-jdk设置\"><span>4. JDK设置</span></a></h2>\n<p>ES的启动需要jdk环境，默认情况下，如果Linux系统中安装了Java环境，ES会直接去找系统的jdk。</p>\n<p>ES自己也带有jdk，默认情况下，如果Linux系统中没有Java环境，ES会使用自己的jdk。</p>\n<div class=\"hint-container note\">\n<p class=\"hint-container-title\">注</p>\n<p>建议在启动ES时使用ES自己的jdk，因为ES版本和jdk版本是有关联的，正常情况下，Linux系统级的jdk版本是不可修改的，不能因为要使用ES就修改系统级的jdk版本。</p>\n</div>\n<h2 id=\"_5-设置es使用es自己的jdk\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_5-设置es使用es自己的jdk\"><span>5. 设置ES使用ES自己的jdk</span></a></h2>\n<p>个人尝试了三个ES版本：<code v-pre>8.15.1</code>,<code v-pre>8.15.2</code>,<code v-pre>7.17.18</code></p>\n<h3 id=\"_5-1-8-x版本\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_5-1-8-x版本\"><span>5.1  <code v-pre>8.x版本</code></span></a></h3>\n<p>对应 <code v-pre>8.15.1</code>,<code v-pre>8.15.2</code> 版本或者说 <code v-pre>8.x</code>版本（8.x其他版本没试，只是猜测）的变化不大，设置方式如下：</p>\n<p>进入到es安装包目录的<code v-pre>bin</code> 目录下找到<code v-pre>elasticsearch</code> 文件</p>\n<p><img src=\"@source/notes/Elasticsearch/Centos下安装ES/assets/image-20241012103528908-1728700535391-2.png\" alt=\"image-20241012103528908\"></p>\n<p>编辑文件 <code v-pre>vim elasticsearch</code>，设置ES自己的jdk环境，<code v-pre>一定要把设置放在最下边</code></p>\n<p><img src=\"@source/notes/Elasticsearch/Centos下安装ES/assets/image-20241012103628927.png\" alt=\"image-20241012103628927\"></p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># JAVA_HOME 目录需要改成自己的es的jdk目录</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">export</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> JAVA_HOME</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">home</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">soft</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">elasticsearch-8</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">15</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">jdk</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">export</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> PATH</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$JAVA_HOME</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">bin</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">:</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$PATH</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">export</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> CLASSPATH</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.:</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$JAVA_HOME</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">lib</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">dt</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">jar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">:</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$JAVA_HOME</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">lib</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">tool</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">jar</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_5-2-对于7-17-18-版本\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_5-2-对于7-17-18-版本\"><span>5.2  对于<code v-pre>7.17.18</code> 版本</span></a></h3>\n<p><code v-pre>7.17.18</code>版本的<code v-pre>elasticsearch</code>文件和<code v-pre>8.15.x</code>版本的<code v-pre>elasticsearch</code>文件差别很大，我也没做研究</p>\n<p>我的环境是jdk17,没有修改jdk就可以，所以这里就不赘述了</p>\n<h2 id=\"_6-设置参数配置\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_6-设置参数配置\"><span>6. 设置参数配置</span></a></h2>\n<h3 id=\"_6-1-设置es配置文件-elasticsearch-yml\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_6-1-设置es配置文件-elasticsearch-yml\"><span>6.1 设置ES配置文件(elasticsearch.yml)</span></a></h3>\n<p>位置：<code v-pre>ES包/config/elasticsearch.yml</code></p>\n<p>内容如下：</p>\n<div class=\"language-yaml line-numbers-mode\" data-ext=\"yaml\" data-title=\"yaml\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ======================== Elasticsearch Configuration =========================</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># NOTE: Elasticsearch comes with reasonable defaults for most settings.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#       Before you set out to tweak and tune the configuration, make sure you</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#       understand what are you trying to accomplish and the consequences.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># The primary way of configuring a node is via this file. This template lists</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># the most important settings you may want to configure for a production cluster.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Please consult the documentation for further information on configuration options:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># https://www.elastic.co/guide/en/elasticsearch/reference/index.html</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ---------------------------------- Cluster -----------------------------------</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Use a descriptive name for your cluster:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 集群名称</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">cluster.name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> elasticsearch</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ------------------------------------ Node ------------------------------------</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Use a descriptive name for the node:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 节点名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">node.name</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> node-1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Add custom attributes to the node:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#node.attr.rack: r1</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ----------------------------------- Paths ------------------------------------</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Path to directory where to store the data (separate multiple locations by comma):</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 数据存放位置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">path.data</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">  /home/soft/elasticsearch-7.17.18/data</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Path to log files:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 日志存放位置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">path.logs</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /home/soft/elasticsearch-7.17.18/logs</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ----------------------------------- Memory -----------------------------------</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Lock the memory on startup:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#bootstrap.memory_lock: true</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Make sure that the heap size is set to about half the memory available</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># on the system and that the owner of the process is allowed to use this</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># limit.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Elasticsearch performs poorly when the system is swapping the memory.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ---------------------------------- Network -----------------------------------</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># By default Elasticsearch is only accessible on localhost. Set a different</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># address here to expose this node on the network:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 设置所有机器都可以访问</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">network.host</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 0.0.0.0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># By default Elasticsearch listens for HTTP traffic on the first free port it</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># finds starting at 9200. Set a specific HTTP port here:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 设置端口</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">http.port</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 9200</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># For more information, consult the network module documentation.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># --------------------------------- Discovery ----------------------------------</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Pass an initial list of hosts to perform discovery when this node is started:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># The default list of hosts is [\"127.0.0.1\", \"[::1]\"]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#discovery.seed_hosts: [\"host1\", \"host2\"]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Bootstrap the cluster using an initial set of master-eligible nodes:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">cluster.initial_master_nodes</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\"> [</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">node-1</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># For more information, consult the discovery and cluster formation module documentation.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ---------------------------------- Various -----------------------------------</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Require explicit names when deleting indices:</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#action.destructive_requires_name: true</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># ---------------------------------- Security ----------------------------------</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#                                 *** WARNING ***</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Elasticsearch security features are not enabled by default.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># These features are free, but require configuration changes to enable them.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># This means that users don’t have to provide credentials and can get full access</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># to the cluster. Network connections are also not encrypted.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># To protect your data, we strongly encourage you to enable the Elasticsearch security features. </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># Refer to the following documentation for instructions.</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">#</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># https://www.elastic.co/guide/en/elasticsearch/reference/7.16/configuring-stack-security.html</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 开启es跨域</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">http.cors.enabled</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> true</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">http.cors.allow-origin</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">*</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">http.cors.allow-headers</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> Authorization</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># # # 开启安全控制</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">xpack.security.enabled</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> true</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">xpack.security.transport.ssl.enabled</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">:</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> true</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_6-2-修改jvm启动参数\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_6-2-修改jvm启动参数\"><span>6.2 修改jvm启动参数</span></a></h3>\n<p>防止撑满内存</p>\n<p>位置：<code v-pre>es包/config/jvm.options</code></p>\n<p><img src=\"@source/notes/Elasticsearch/Centos下安装ES/assets/image-20241012110731047.png\" alt=\"image-20241012110731047\"></p>\n<h3 id=\"_6-3-修改-etc-security-limits-conf\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_6-3-修改-etc-security-limits-conf\"><span>6.3 修改/etc/security/limits.conf</span></a></h3>\n<p>vim /etc/security/limits.conf</p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 在文件末尾中增加下面内容</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 每个进程可以打开的文件数的限制</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">es</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> soft</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> nofile</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 65536</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">es</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> hard</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> nofile</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 65536</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_6-4-修改-etc-security-limits-d-20-nproc-conf\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_6-4-修改-etc-security-limits-d-20-nproc-conf\"><span>6.4 修改/etc/security/limits.d/20-nproc.conf</span></a></h3>\n<p>vim /etc/security/limits.d/20-nproc.conf</p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 在文件末尾中增加下面内容</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 每个进程可以打开的文件数的限制</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">es</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> soft</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> nofile</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 65536</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">es</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> hard</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> nofile</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 65536</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 操作系统级别对每个用户创建的进程数的限制</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">*</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> hard nproc 4096</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 注： * 带表 Linux 所有用户名称</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_6-5-修改-etc-sysctl-conf\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_6-5-修改-etc-sysctl-conf\"><span>6.5 修改/etc/sysctl.conf</span></a></h3>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 在文件中增加下面内容</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 一个进程可以拥有的 VMA(虚拟内存区域)的数量,默认值为 65536</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">vm.max_map_count</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">=655360</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_6-6-重新加载或重启linux系统\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_6-6-重新加载或重启linux系统\"><span>6.6 重新加载或重启Linux系统</span></a></h3>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">sysctl</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -p</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h2 id=\"_7-启动\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_7-启动\"><span>7. 启动</span></a></h2>\n<p>进入：<code v-pre>es包/bin</code></p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 切换到上面添加的es用户</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">su</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> es</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 非后台启动，关闭命令行则es关闭,建议安装测试阶段使用该方式，也容易查看报错记录</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">./elasticsearch</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 后台启动</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">./elasticsearch</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -d</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_8-设置或修改-es密码\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_8-设置或修改-es密码\"><span>8. 设置或修改 ES密码</span></a></h2>\n<p>进入 <code v-pre>es包/bin</code></p>\n<p>7.x版本和8.x版本有些不同，7.x版本没有设置密码只有重置密码</p>\n<p>7.x</p>\n<p><img src=\"@source/notes/Elasticsearch/Centos下安装ES/assets/image-20241012111552636.png\" alt=\"image-20241012111552636\"></p>\n<p>8.x</p>\n<p><img src=\"@source/notes/Elasticsearch/Centos下安装ES/assets/image-20241012111620565.png\" alt=\"image-20241012111620565\"></p>\n<p>设置密码方式：</p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 设置密码</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> ./elasticsearch-setup-passwords</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> interactive</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 重置密码</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\"> ./elasticsearch-reset-passwords</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> interactive</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_9-访问测试是否成功\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_9-访问测试是否成功\"><span>9. 访问测试是否成功</span></a></h2>\n<p>使用默认的9200（上面配置文件设置的端口）端口访问，如下则表示启动成功</p>\n<p><img src=\"@source/notes/Elasticsearch/Centos下安装ES/assets/image-20241012112000741.png\" alt=\"image-20241012112000741\"></p>\n<h2 id=\"_10-安装插件\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_10-安装插件\"><span>10. 安装插件</span></a></h2>\n<div class=\"hint-container warning\">\n<p class=\"hint-container-title\">注意</p>\n<p>ES插件需要和ES版本号相对应</p>\n</div>\n<p>拼音插件地址：https://github.com/infinilabs/analysis-pinyin/releases\n分词插件地址：https://github.com/infinilabs/analysis-ik/releases</p>\n<p>下载这个zip</p>\n<p><img src=\"@source/notes/Elasticsearch/Centos下安装ES/assets/image-20241012114257117.png\" alt=\"image-20241012114257117\"></p>\n<p>然后解压放到 <code v-pre>es包/plugins</code>下，重启es即可</p>\n<p><img src=\"@source/notes/Elasticsearch/Centos下安装ES/assets/image-20241012114401042.png\" alt=\"image-20241012114401042\"></p>\n","tagOpen":"<template>","tagClose":"</template>"},"script":null,"scriptSetup":null,"scripts":[],"styles":[],"customBlocks":[]},"content":"\n# Centos下安装Elasticsearch记录\r\n\r\n## 1. 下载ES\r\n\r\n下载地址：https://www.elastic.co/cn/downloads/past-releases\r\n\r\n相应的版本对应相应地址规则，例如：https://www.elastic.co/cn/downloads/past-releases/elasticsearch-7-8-0\r\n\r\n如图：\r\n\r\n![image-20241012101124866](assets/image-20241012101124866.png)\r\n\r\nES版本和jdk版本对应关系：https://www.elastic.co/cn/support/matrix#matrix_jvm\r\n\r\n> [!warning]\r\n>\r\n> 需要下载和Linux系统架构一致的ES安装包\r\n\r\n## 2. 解压tar包并放在安装的目录\r\n\r\n## 3. 创建Linux用户\r\n\r\n在es中`超级管理员`用户是不允许操作es的，因此需要添加其他用户来操作es\r\n\r\n```sh\r\nuseradd es #新增 es 用户\r\npasswd es #为 es 用户设置密码\r\nuserdel -r es #如果错了，可以删除再加\r\nchown -R es:es /opt/module/es #文件夹所有者,即给es用户设置可操作的目录权限\r\n```\r\n\r\n\r\n\r\n## 4. JDK设置\r\n\r\n\r\n\r\nES的启动需要jdk环境，默认情况下，如果Linux系统中安装了Java环境，ES会直接去找系统的jdk。\r\n\r\nES自己也带有jdk，默认情况下，如果Linux系统中没有Java环境，ES会使用自己的jdk。\r\n\r\n\r\n\r\n> [!note]\r\n>\r\n> 建议在启动ES时使用ES自己的jdk，因为ES版本和jdk版本是有关联的，正常情况下，Linux系统级的jdk版本是不可修改的，不能因为要使用ES就修改系统级的jdk版本。\r\n\r\n\r\n\r\n## 5. 设置ES使用ES自己的jdk\r\n\r\n\r\n\r\n个人尝试了三个ES版本：`8.15.1`,`8.15.2`,`7.17.18`\r\n\r\n### 5.1  `8.x版本`\r\n\r\n对应 `8.15.1`,`8.15.2` 版本或者说 `8.x`版本（8.x其他版本没试，只是猜测）的变化不大，设置方式如下：\r\n\r\n进入到es安装包目录的`bin` 目录下找到`elasticsearch` 文件\r\n\r\n![image-20241012103528908](assets/image-20241012103528908-1728700535391-2.png)\r\n\r\n编辑文件 `vim elasticsearch`，设置ES自己的jdk环境，`一定要把设置放在最下边`\r\n\r\n![image-20241012103628927](assets/image-20241012103628927.png)\r\n\r\n\r\n\r\n```sh\r\n# JAVA_HOME 目录需要改成自己的es的jdk目录\r\nexport JAVA_HOME=/home/soft/elasticsearch-8.15.2/jdk\r\nexport PATH=$JAVA_HOME/bin:$PATH\r\nexport CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tool.jar\r\n```\r\n\r\n### 5.2  对于`7.17.18` 版本\r\n\r\n`7.17.18`版本的`elasticsearch`文件和`8.15.x`版本的`elasticsearch`文件差别很大，我也没做研究\r\n\r\n我的环境是jdk17,没有修改jdk就可以，所以这里就不赘述了\r\n\r\n\r\n\r\n## 6. 设置参数配置\r\n\r\n### 6.1 设置ES配置文件(elasticsearch.yml)\r\n\r\n位置：`ES包/config/elasticsearch.yml`\r\n\r\n内容如下：\r\n\r\n```yaml\r\n# ======================== Elasticsearch Configuration =========================\r\n#\r\n# NOTE: Elasticsearch comes with reasonable defaults for most settings.\r\n#       Before you set out to tweak and tune the configuration, make sure you\r\n#       understand what are you trying to accomplish and the consequences.\r\n#\r\n# The primary way of configuring a node is via this file. This template lists\r\n# the most important settings you may want to configure for a production cluster.\r\n#\r\n# Please consult the documentation for further information on configuration options:\r\n# https://www.elastic.co/guide/en/elasticsearch/reference/index.html\r\n#\r\n# ---------------------------------- Cluster -----------------------------------\r\n#\r\n# Use a descriptive name for your cluster:\r\n# 集群名称\r\ncluster.name: elasticsearch\r\n#\r\n# ------------------------------------ Node ------------------------------------\r\n#\r\n# Use a descriptive name for the node:\r\n# 节点名\r\nnode.name: node-1\r\n#\r\n# Add custom attributes to the node:\r\n#\r\n#node.attr.rack: r1\r\n#\r\n# ----------------------------------- Paths ------------------------------------\r\n#\r\n# Path to directory where to store the data (separate multiple locations by comma):\r\n# 数据存放位置\r\npath.data:  /home/soft/elasticsearch-7.17.18/data\r\n#\r\n# Path to log files:\r\n# 日志存放位置\r\npath.logs: /home/soft/elasticsearch-7.17.18/logs\r\n#\r\n# ----------------------------------- Memory -----------------------------------\r\n#\r\n# Lock the memory on startup:\r\n#\r\n#bootstrap.memory_lock: true\r\n#\r\n# Make sure that the heap size is set to about half the memory available\r\n# on the system and that the owner of the process is allowed to use this\r\n# limit.\r\n#\r\n# Elasticsearch performs poorly when the system is swapping the memory.\r\n#\r\n# ---------------------------------- Network -----------------------------------\r\n#\r\n# By default Elasticsearch is only accessible on localhost. Set a different\r\n# address here to expose this node on the network:\r\n# 设置所有机器都可以访问\r\nnetwork.host: 0.0.0.0\r\n#\r\n# By default Elasticsearch listens for HTTP traffic on the first free port it\r\n# finds starting at 9200. Set a specific HTTP port here:\r\n# 设置端口\r\nhttp.port: 9200\r\n#\r\n# For more information, consult the network module documentation.\r\n#\r\n# --------------------------------- Discovery ----------------------------------\r\n#\r\n# Pass an initial list of hosts to perform discovery when this node is started:\r\n# The default list of hosts is [\"127.0.0.1\", \"[::1]\"]\r\n#\r\n#discovery.seed_hosts: [\"host1\", \"host2\"]\r\n#\r\n# Bootstrap the cluster using an initial set of master-eligible nodes:\r\n#\r\ncluster.initial_master_nodes: [\"node-1\"]\r\n#\r\n# For more information, consult the discovery and cluster formation module documentation.\r\n#\r\n# ---------------------------------- Various -----------------------------------\r\n#\r\n# Require explicit names when deleting indices:\r\n#\r\n#action.destructive_requires_name: true\r\n#\r\n# ---------------------------------- Security ----------------------------------\r\n#\r\n#                                 *** WARNING ***\r\n#\r\n# Elasticsearch security features are not enabled by default.\r\n# These features are free, but require configuration changes to enable them.\r\n# This means that users don’t have to provide credentials and can get full access\r\n# to the cluster. Network connections are also not encrypted.\r\n#\r\n# To protect your data, we strongly encourage you to enable the Elasticsearch security features. \r\n# Refer to the following documentation for instructions.\r\n#\r\n# https://www.elastic.co/guide/en/elasticsearch/reference/7.16/configuring-stack-security.html\r\n\r\n\r\n# 开启es跨域\r\nhttp.cors.enabled: true\r\nhttp.cors.allow-origin: \"*\"\r\nhttp.cors.allow-headers: Authorization\r\n# # # 开启安全控制\r\nxpack.security.enabled: true\r\nxpack.security.transport.ssl.enabled: true\r\n```\r\n\r\n\r\n\r\n\r\n\r\n### 6.2 修改jvm启动参数\r\n\r\n防止撑满内存\r\n\r\n位置：`es包/config/jvm.options`\r\n\r\n![image-20241012110731047](assets/image-20241012110731047.png)\r\n\r\n\r\n\r\n\r\n\r\n### 6.3 修改/etc/security/limits.conf\r\n\r\nvim /etc/security/limits.conf\r\n\r\n```sh\r\n# 在文件末尾中增加下面内容\r\n# 每个进程可以打开的文件数的限制\r\nes soft nofile 65536\r\nes hard nofile 65536\r\n```\r\n\r\n\r\n\r\n### 6.4 修改/etc/security/limits.d/20-nproc.conf\r\n\r\nvim /etc/security/limits.d/20-nproc.conf\r\n\r\n```sh\r\n# 在文件末尾中增加下面内容\r\n# 每个进程可以打开的文件数的限制\r\nes soft nofile 65536\r\nes hard nofile 65536\r\n# 操作系统级别对每个用户创建的进程数的限制\r\n* hard nproc 4096\r\n# 注： * 带表 Linux 所有用户名称\r\n```\r\n\r\n\r\n\r\n### 6.5 修改/etc/sysctl.conf\r\n\r\n```sh\r\n# 在文件中增加下面内容\r\n# 一个进程可以拥有的 VMA(虚拟内存区域)的数量,默认值为 65536\r\nvm.max_map_count=655360\r\n```\r\n\r\n\r\n\r\n### 6.6 重新加载或重启Linux系统\r\n\r\n```sh\r\nsysctl -p\r\n```\r\n\r\n\r\n\r\n\r\n\r\n## 7. 启动\r\n\r\n进入：`es包/bin`\r\n\r\n```sh\r\n# 切换到上面添加的es用户\r\nsu es\r\n\r\n# 非后台启动，关闭命令行则es关闭,建议安装测试阶段使用该方式，也容易查看报错记录\r\n./elasticsearch\r\n\r\n# 后台启动\r\n./elasticsearch -d\r\n\r\n```\r\n\r\n\r\n\r\n## 8. 设置或修改 ES密码\r\n\r\n\r\n\r\n进入 `es包/bin`\r\n\r\n7.x版本和8.x版本有些不同，7.x版本没有设置密码只有重置密码\r\n\r\n7.x\r\n\r\n![image-20241012111552636](assets/image-20241012111552636.png)\r\n\r\n\r\n\r\n8.x\r\n\r\n![image-20241012111620565](assets/image-20241012111620565.png)\r\n\r\n\r\n\r\n设置密码方式：\r\n\r\n```sh\r\n# 设置密码\r\n ./elasticsearch-setup-passwords interactive\r\n\r\n# 重置密码\r\n ./elasticsearch-reset-passwords interactive\r\n```\r\n\r\n\r\n\r\n## 9. 访问测试是否成功\r\n\r\n使用默认的9200（上面配置文件设置的端口）端口访问，如下则表示启动成功\r\n\r\n![image-20241012112000741](assets/image-20241012112000741.png)\r\n\r\n## 10. 安装插件\r\n\r\n\r\n\r\n> [!warning]\r\n>\r\n> ES插件需要和ES版本号相对应\r\n\r\n\r\n\r\n拼音插件地址：https://github.com/infinilabs/analysis-pinyin/releases\r\n分词插件地址：https://github.com/infinilabs/analysis-ik/releases\r\n\r\n下载这个zip\r\n\r\n![image-20241012114257117](assets/image-20241012114257117.png)\r\n\r\n\r\n\r\n然后解压放到 `es包/plugins`下，重启es即可\r\n\r\n![image-20241012114401042](assets/image-20241012114401042.png)","excerpt":"","includedFiles":[],"tasklists":0,"title":"Centos下安装Elasticsearch记录","headers":[{"level":2,"title":"1. 下载ES","slug":"_1-下载es","link":"#_1-下载es","children":[]},{"level":2,"title":"2. 解压tar包并放在安装的目录","slug":"_2-解压tar包并放在安装的目录","link":"#_2-解压tar包并放在安装的目录","children":[]},{"level":2,"title":"3. 创建Linux用户","slug":"_3-创建linux用户","link":"#_3-创建linux用户","children":[]},{"level":2,"title":"4. JDK设置","slug":"_4-jdk设置","link":"#_4-jdk设置","children":[]},{"level":2,"title":"5. 设置ES使用ES自己的jdk","slug":"_5-设置es使用es自己的jdk","link":"#_5-设置es使用es自己的jdk","children":[{"level":3,"title":"5.1  8.x版本","slug":"_5-1-8-x版本","link":"#_5-1-8-x版本","children":[]},{"level":3,"title":"5.2  对于7.17.18 版本","slug":"_5-2-对于7-17-18-版本","link":"#_5-2-对于7-17-18-版本","children":[]}]},{"level":2,"title":"6. 设置参数配置","slug":"_6-设置参数配置","link":"#_6-设置参数配置","children":[{"level":3,"title":"6.1 设置ES配置文件(elasticsearch.yml)","slug":"_6-1-设置es配置文件-elasticsearch-yml","link":"#_6-1-设置es配置文件-elasticsearch-yml","children":[]},{"level":3,"title":"6.2 修改jvm启动参数","slug":"_6-2-修改jvm启动参数","link":"#_6-2-修改jvm启动参数","children":[]},{"level":3,"title":"6.3 修改/etc/security/limits.conf","slug":"_6-3-修改-etc-security-limits-conf","link":"#_6-3-修改-etc-security-limits-conf","children":[]},{"level":3,"title":"6.4 修改/etc/security/limits.d/20-nproc.conf","slug":"_6-4-修改-etc-security-limits-d-20-nproc-conf","link":"#_6-4-修改-etc-security-limits-d-20-nproc-conf","children":[]},{"level":3,"title":"6.5 修改/etc/sysctl.conf","slug":"_6-5-修改-etc-sysctl-conf","link":"#_6-5-修改-etc-sysctl-conf","children":[]},{"level":3,"title":"6.6 重新加载或重启Linux系统","slug":"_6-6-重新加载或重启linux系统","link":"#_6-6-重新加载或重启linux系统","children":[]}]},{"level":2,"title":"7. 启动","slug":"_7-启动","link":"#_7-启动","children":[]},{"level":2,"title":"8. 设置或修改 ES密码","slug":"_8-设置或修改-es密码","link":"#_8-设置或修改-es密码","children":[]},{"level":2,"title":"9. 访问测试是否成功","slug":"_9-访问测试是否成功","link":"#_9-访问测试是否成功","children":[]},{"level":2,"title":"10. 安装插件","slug":"_10-安装插件","link":"#_10-安装插件","children":[]}]}}
