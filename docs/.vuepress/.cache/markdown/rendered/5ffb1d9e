{"content":"<h1 id=\"docker镜像制作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#docker镜像制作\"><span>Docker镜像制作</span></a></h1>\n<h2 id=\"_1-通过容器制作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-通过容器制作\"><span>1. 通过容器制作</span></a></h2>\n<h3 id=\"_1-1-制作一个带有java17环境的镜像\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-1-制作一个带有java17环境的镜像\"><span>1.1 制作一个带有java17环境的镜像</span></a></h3>\n<ol>\n<li>\n<p>启动镜像（centos）并使用容器卷挂载目录，使得容器内部可以有jdk安装包</p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> run</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -it</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> --name</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> centos_jdk17</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -v</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /home/soft:/usr/lib</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> centos</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div></li>\n<li>\n<p>安装jdk环境</p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 1. 安装jdk17 JAVA_HOME 即为jdk位置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">export</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> JAVA_HOME</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">usr</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">lib</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">jdk-17</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">10</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">export</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> CLASSPATH</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.:</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">${</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">JAVA_HOME</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">jre</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">lib</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">rt</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">jar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">:</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">${</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">JAVA_HOME</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">lib</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">dt</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">jar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">:</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">${</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">JAVA_HOME</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">lib</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">tools</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">jar</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">export</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> PATH</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$PATH</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">:</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">${</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">JAVA_HOME</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">bin</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 2. 刷新配置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">source</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /etc/profile</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 2. 检查环境</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">java</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -version</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></li>\n</ol>\n<h3 id=\"_1-2-将容器打包成镜像\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-2-将容器打包成镜像\"><span>1.2 将容器打包成镜像</span></a></h3>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 打包成镜像</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> commit</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [将要制作镜像的容器名] </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">将要生成的镜像名</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 标记镜像</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> tag</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [镜像名] </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">harobr domain</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">harbor项目名称</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">仓库名称</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">:版本号</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> tag</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> centos_pigx_jdk17:latest</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 192.168.1.100/shunde/centos_pigx_jdk17:v1.0</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_1-3-推送镜像至harbor仓库\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-3-推送镜像至harbor仓库\"><span>1.3 推送镜像至Harbor仓库</span></a></h3>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 登录至Harbor仓库</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> login</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [harbor </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">domain]</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 推送</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> push</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 192.168.1.100/shunde/centos_pigx_jdk17:v1.0</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_2-制作镜像\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-制作镜像\"><span>2. 制作镜像</span></a></h2>\n<h3 id=\"_2-1-通过现有容器制作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-1-通过现有容器制作\"><span>2.1 通过现有容器制作</span></a></h3>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> commit</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -a</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">作者信息</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 容器id</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h3 id=\"_2-2-通过dockerfile制作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-2-通过dockerfile制作\"><span>2.2 通过Dockerfile制作</span></a></h3>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> build</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -t</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 镜像名:镜像版本</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> .</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div>","env":{"base":"/","filePath":"C:/Users/kylinBachelor/Desktop/my-project/docs/notes/Docker/制作镜像/index.md","filePathRelative":"notes/Docker/制作镜像/index.md","frontmatter":{},"sfcBlocks":{"template":{"type":"template","content":"<template><h1 id=\"docker镜像制作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#docker镜像制作\"><span>Docker镜像制作</span></a></h1>\n<h2 id=\"_1-通过容器制作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-通过容器制作\"><span>1. 通过容器制作</span></a></h2>\n<h3 id=\"_1-1-制作一个带有java17环境的镜像\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-1-制作一个带有java17环境的镜像\"><span>1.1 制作一个带有java17环境的镜像</span></a></h3>\n<ol>\n<li>\n<p>启动镜像（centos）并使用容器卷挂载目录，使得容器内部可以有jdk安装包</p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> run</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -it</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> --name</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> centos_jdk17</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -v</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /home/soft:/usr/lib</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> centos</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div></li>\n<li>\n<p>安装jdk环境</p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 1. 安装jdk17 JAVA_HOME 即为jdk位置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">export</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> JAVA_HOME</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">usr</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">lib</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">jdk-17</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">10</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">export</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> CLASSPATH</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.:</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">${</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">JAVA_HOME</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">jre</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">lib</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">rt</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">jar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">:</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">${</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">JAVA_HOME</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">lib</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">dt</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">jar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">:</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">${</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">JAVA_HOME</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">lib</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">tools</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">jar</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">export</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> PATH</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$PATH</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">:</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">${</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">JAVA_HOME</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">bin</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 2. 刷新配置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">source</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /etc/profile</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 2. 检查环境</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">java</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -version</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></li>\n</ol>\n<h3 id=\"_1-2-将容器打包成镜像\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-2-将容器打包成镜像\"><span>1.2 将容器打包成镜像</span></a></h3>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 打包成镜像</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> commit</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [将要制作镜像的容器名] </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">将要生成的镜像名</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 标记镜像</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> tag</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [镜像名] </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">harobr domain</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">harbor项目名称</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">仓库名称</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">:版本号</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> tag</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> centos_pigx_jdk17:latest</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 192.168.1.100/shunde/centos_pigx_jdk17:v1.0</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_1-3-推送镜像至harbor仓库\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-3-推送镜像至harbor仓库\"><span>1.3 推送镜像至Harbor仓库</span></a></h3>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 登录至Harbor仓库</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> login</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [harbor </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">domain]</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 推送</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> push</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 192.168.1.100/shunde/centos_pigx_jdk17:v1.0</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_2-制作镜像\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-制作镜像\"><span>2. 制作镜像</span></a></h2>\n<h3 id=\"_2-1-通过现有容器制作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-1-通过现有容器制作\"><span>2.1 通过现有容器制作</span></a></h3>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> commit</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -a</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">作者信息</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 容器id</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h3 id=\"_2-2-通过dockerfile制作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-2-通过dockerfile制作\"><span>2.2 通过Dockerfile制作</span></a></h3>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> build</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -t</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 镜像名:镜像版本</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> .</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div></template>","contentStripped":"<h1 id=\"docker镜像制作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#docker镜像制作\"><span>Docker镜像制作</span></a></h1>\n<h2 id=\"_1-通过容器制作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-通过容器制作\"><span>1. 通过容器制作</span></a></h2>\n<h3 id=\"_1-1-制作一个带有java17环境的镜像\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-1-制作一个带有java17环境的镜像\"><span>1.1 制作一个带有java17环境的镜像</span></a></h3>\n<ol>\n<li>\n<p>启动镜像（centos）并使用容器卷挂载目录，使得容器内部可以有jdk安装包</p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> run</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -it</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> --name</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> centos_jdk17</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -v</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /home/soft:/usr/lib</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> centos</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div></li>\n<li>\n<p>安装jdk环境</p>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 1. 安装jdk17 JAVA_HOME 即为jdk位置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">export</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> JAVA_HOME</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">usr</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">lib</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">jdk-17</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">10</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">export</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> CLASSPATH</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.:</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">${</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">JAVA_HOME</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">jre</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">lib</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">rt</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">jar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">:</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">${</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">JAVA_HOME</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">lib</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">dt</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">jar</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">:</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">${</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">JAVA_HOME</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">lib</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">tools</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">jar</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">export</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\"> PATH</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">=</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">$PATH</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">:</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">${</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">JAVA_HOME</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">}</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#B07D48;--shiki-dark:#BD976A\">bin</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 2. 刷新配置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#998418;--shiki-dark:#B8A965\">source</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> /etc/profile</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 2. 检查环境</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">java</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -version</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div></li>\n</ol>\n<h3 id=\"_1-2-将容器打包成镜像\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-2-将容器打包成镜像\"><span>1.2 将容器打包成镜像</span></a></h3>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 打包成镜像</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> commit</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [将要制作镜像的容器名] </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">将要生成的镜像名</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 标记镜像</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> tag</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [镜像名] </span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">harobr domain</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">harbor项目名称</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">[</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">仓库名称</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">]</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">:版本号</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> tag</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> centos_pigx_jdk17:latest</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 192.168.1.100/shunde/centos_pigx_jdk17:v1.0</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_1-3-推送镜像至harbor仓库\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-3-推送镜像至harbor仓库\"><span>1.3 推送镜像至Harbor仓库</span></a></h3>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 登录至Harbor仓库</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> login</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> [harbor </span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">domain]</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\"># 推送</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> push</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 192.168.1.100/shunde/centos_pigx_jdk17:v1.0</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_2-制作镜像\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-制作镜像\"><span>2. 制作镜像</span></a></h2>\n<h3 id=\"_2-1-通过现有容器制作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-1-通过现有容器制作\"><span>2.1 通过现有容器制作</span></a></h3>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> commit</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -a</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">作者信息</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 容器id</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h3 id=\"_2-2-通过dockerfile制作\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-2-通过dockerfile制作\"><span>2.2 通过Dockerfile制作</span></a></h3>\n<div class=\"language-sh line-numbers-mode\" data-ext=\"sh\" data-title=\"sh\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> build</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> -t</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> 镜像名:镜像版本</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\"> .</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div>","tagOpen":"<template>","tagClose":"</template>"},"script":null,"scriptSetup":null,"scripts":[],"styles":[],"customBlocks":[]},"content":"\n# Docker镜像制作\r\n\r\n## 1. 通过容器制作\r\n\r\n### 1.1 制作一个带有java17环境的镜像\r\n\r\n1. 启动镜像（centos）并使用容器卷挂载目录，使得容器内部可以有jdk安装包\r\n\r\n    ```sh\r\n    docker run -it --name centos_jdk17 -v /home/soft:/usr/lib centos\r\n    ```\r\n\r\n2. 安装jdk环境\r\n\r\n    ```sh\r\n    # 1. 安装jdk17 JAVA_HOME 即为jdk位置\r\n    export JAVA_HOME=/usr/lib/jdk-17.0.10\r\n    export CLASSPATH=.:${JAVA_HOME}/jre/lib/rt.jar:${JAVA_HOME}/lib/dt.jar:${JAVA_HOME}/lib/tools.jar\r\n    export PATH=$PATH:${JAVA_HOME}/bin\r\n    \r\n    # 2. 刷新配置\r\n    source /etc/profile\r\n    \r\n    # 2. 检查环境\r\n    java -version\r\n    ```\r\n\r\n\r\n\r\n### 1.2 将容器打包成镜像\r\n\r\n\r\n\r\n```sh\r\n# 打包成镜像\r\ndocker commit [将要制作镜像的容器名] [将要生成的镜像名]\r\n\r\n\r\n# 标记镜像\r\ndocker tag [镜像名] [harobr domain]/[harbor项目名称]/[仓库名称]:版本号\r\ndocker tag centos_pigx_jdk17:latest 192.168.1.100/shunde/centos_pigx_jdk17:v1.0\r\n```\r\n\r\n\r\n\r\n### 1.3 推送镜像至Harbor仓库\r\n\r\n```sh\r\n# 登录至Harbor仓库\r\ndocker login [harbor domain]\r\n\r\n# 推送\r\ndocker push 192.168.1.100/shunde/centos_pigx_jdk17:v1.0\r\n```\r\n\r\n\r\n\r\n## 2. 制作镜像\r\n\r\n### 2.1 通过现有容器制作\r\n\r\n```sh\r\ndocker commit -a \"作者信息\" 容器id\r\n```\r\n\r\n\r\n\r\n### 2.2 通过Dockerfile制作\r\n\r\n```sh\r\ndocker build -t 镜像名:镜像版本 .\r\n```","excerpt":"","includedFiles":[],"tasklists":0,"title":"Docker镜像制作","headers":[{"level":2,"title":"1. 通过容器制作","slug":"_1-通过容器制作","link":"#_1-通过容器制作","children":[{"level":3,"title":"1.1 制作一个带有java17环境的镜像","slug":"_1-1-制作一个带有java17环境的镜像","link":"#_1-1-制作一个带有java17环境的镜像","children":[]},{"level":3,"title":"1.2 将容器打包成镜像","slug":"_1-2-将容器打包成镜像","link":"#_1-2-将容器打包成镜像","children":[]},{"level":3,"title":"1.3 推送镜像至Harbor仓库","slug":"_1-3-推送镜像至harbor仓库","link":"#_1-3-推送镜像至harbor仓库","children":[]}]},{"level":2,"title":"2. 制作镜像","slug":"_2-制作镜像","link":"#_2-制作镜像","children":[{"level":3,"title":"2.1 通过现有容器制作","slug":"_2-1-通过现有容器制作","link":"#_2-1-通过现有容器制作","children":[]},{"level":3,"title":"2.2 通过Dockerfile制作","slug":"_2-2-通过dockerfile制作","link":"#_2-2-通过dockerfile制作","children":[]}]}]}}
