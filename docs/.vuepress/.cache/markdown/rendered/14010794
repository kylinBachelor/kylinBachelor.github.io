{"content":"<h2 id=\"_1-with-as\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-with-as\"><span>1. with....as</span></a></h2>\n<p>with...as也叫子查询，用来定义一个sql片段，且该片段会被整个sql语句反复使用很多次，这个sql片段就相当于是一个公用临时表</p>\n<p>例如：</p>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- 针对一个别名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">with</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> temp </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">as</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> aTable)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> temp</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- 针对多个别名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">with</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">tmp </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">as</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> tb_name),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">tmp2 </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">as</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> tb_name2),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">tmp3 </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">as</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> tb_name3),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">....</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">tempn </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">as</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> tb_namen)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> tmp,tmp2 </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">where</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> tmp</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">id</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">tmp2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">id</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_2-find-in-set\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-find-in-set\"><span>2. find_in_set</span></a></h2>\n<p>用法示例</p>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- find_in_set(搜索字段，被搜索字段)用来查询被搜索字段以逗号分隔的数据</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> find_in_set(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">a</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">a,b,c,d,e</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_3-case-when-then\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-case-when-then\"><span>3. case  when  then</span></a></h2>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">SELECT</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, (</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">CASE</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">             WHEN</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sex</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> THEN</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">男</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">             WHEN</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sex</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> THEN</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">女</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">             WHEN</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sex</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">3</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> THEN</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">神仙</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">             ELSE</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">性别出现异常</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">            END</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        ) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">AS</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> 性别 </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">FROM</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> person;</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_4-ifnull\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_4-ifnull\"><span>4. IFNULL</span></a></h2>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- 如果成绩为空则显示为0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">SELECT</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> ifnull</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(score, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">FROM</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> student;</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_5-if\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_5-if\"><span>5.IF</span></a></h2>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- 如果分数大于90分则为几个，否则为不及格</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">SELECT</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> IF</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(score</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">90</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">及格</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">不及格</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">FROM</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> student;</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_6-if-else\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_6-if-else\"><span>6. IF....ELSE</span></a></h2>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">IF</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> search_condition </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">THEN</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">\tstatement_list</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">ELSEIF search_condition </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">THEN</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">\tstatement_list</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">ELSE</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">\tstatement_list</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">END</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> IF</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_7-data-format\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_7-data-format\"><span>7. data_format</span></a></h2>\n<p>时间格式化</p>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> date_format</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NOW</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">()</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">%Y-%m-%d</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h2 id=\"_8-upsert\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_8-upsert\"><span>8. upsert</span></a></h2>\n<p>语法：</p>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">UPSERT </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">INTO</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> table_name (字段1, 字段2，……) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">VALUES</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (字段1值, 字段2值, ……);</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>mysql数据库中没有upsert可用下方示例替换</p>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- 说明</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">INSERT INTO</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> table_name (字段1, 字段2, ……)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">values</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (字段1值, 字段2值, ……)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">ON</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> DUPLICATE </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">KEY</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> UPDATE</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- 示例</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">INSERT INTO</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> employee (id, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, email) </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">VALUES</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Danny</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">danny.liu@krem.corp</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">ON</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> DUPLICATE </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">KEY</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> UPDATE</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>PostgreSQL数据库中没有upsert可用下方示例替换</p>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- 说明</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">INSERT INTO</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> table_name (字段1, 字段2, ……)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">values</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (字段1值, 字段2值, ……)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">ON</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> CONFLICT 冲突字段 冲突动作;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- 示例</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">INSERT INTO</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> employees (id, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, email) </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">VALUES</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Danny</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">danny.liu@krem.corp</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">ON</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> CONFLICT (id) DO </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">UPDATE</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_9-获取明天的时间\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_9-获取明天的时间\"><span>9. 获取明天的时间</span></a></h2>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">SELECT</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> DATE_ADD(</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">now</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">()</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, INTERVAL </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> DAY</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">AS</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> tomorrow;</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h2 id=\"_10-事务的使用\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_10-事务的使用\"><span>10. 事务的使用</span></a></h2>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">START TRANSACTION</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">SELECT</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> value</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> FROM</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> serial_number </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">FOR</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> UPDATE</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">UPDATE</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> serial_number </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">SET</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> value</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> =</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> value</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> +</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">COMMIT</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>代码说明：</p>\n<ul>\n<li>START TRANSACTION：开启一个事务</li>\n<li>SELECT value FROM serial_number FOR UPDATE;使用FOR UPDATE语句锁定serial_number表的记录，确保其他事务不能同时读取和修改该记录。</li>\n<li>UPDATE serial_number SET value = value + 1：将序列号的值加1。</li>\n<li>COMMIT：提交事务。</li>\n</ul>\n<h2 id=\"_11-uuid-生成唯一主键\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_11-uuid-生成唯一主键\"><span>11.UUID()：生成唯一主键</span></a></h2>\n","env":{"base":"/","filePath":"F:/my_source_code/kylinBachelor.github.io/docs/article/technology/Mysql常用的函数/Mysql常用函数.md","filePathRelative":"article/technology/Mysql常用的函数/Mysql常用函数.md","frontmatter":{"title":"MySQL常用函数","aliases":null,"tags":["MySQL","SQL"],"description":"MySQL常用函数","createTime":"2024/11/30 14:15:41","draft":false},"sfcBlocks":{"template":{"type":"template","content":"<template><h2 id=\"_1-with-as\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-with-as\"><span>1. with....as</span></a></h2>\n<p>with...as也叫子查询，用来定义一个sql片段，且该片段会被整个sql语句反复使用很多次，这个sql片段就相当于是一个公用临时表</p>\n<p>例如：</p>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- 针对一个别名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">with</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> temp </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">as</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> aTable)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> temp</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- 针对多个别名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">with</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">tmp </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">as</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> tb_name),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">tmp2 </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">as</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> tb_name2),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">tmp3 </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">as</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> tb_name3),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">....</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">tempn </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">as</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> tb_namen)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> tmp,tmp2 </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">where</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> tmp</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">id</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">tmp2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">id</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_2-find-in-set\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-find-in-set\"><span>2. find_in_set</span></a></h2>\n<p>用法示例</p>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- find_in_set(搜索字段，被搜索字段)用来查询被搜索字段以逗号分隔的数据</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> find_in_set(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">a</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">a,b,c,d,e</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_3-case-when-then\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-case-when-then\"><span>3. case  when  then</span></a></h2>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">SELECT</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, (</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">CASE</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">             WHEN</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sex</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> THEN</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">男</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">             WHEN</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sex</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> THEN</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">女</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">             WHEN</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sex</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">3</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> THEN</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">神仙</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">             ELSE</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">性别出现异常</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">            END</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        ) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">AS</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> 性别 </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">FROM</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> person;</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_4-ifnull\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_4-ifnull\"><span>4. IFNULL</span></a></h2>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- 如果成绩为空则显示为0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">SELECT</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> ifnull</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(score, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">FROM</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> student;</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_5-if\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_5-if\"><span>5.IF</span></a></h2>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- 如果分数大于90分则为几个，否则为不及格</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">SELECT</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> IF</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(score</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">90</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">及格</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">不及格</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">FROM</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> student;</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_6-if-else\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_6-if-else\"><span>6. IF....ELSE</span></a></h2>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">IF</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> search_condition </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">THEN</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">\tstatement_list</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">ELSEIF search_condition </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">THEN</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">\tstatement_list</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">ELSE</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">\tstatement_list</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">END</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> IF</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_7-data-format\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_7-data-format\"><span>7. data_format</span></a></h2>\n<p>时间格式化</p>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> date_format</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NOW</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">()</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">%Y-%m-%d</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h2 id=\"_8-upsert\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_8-upsert\"><span>8. upsert</span></a></h2>\n<p>语法：</p>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">UPSERT </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">INTO</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> table_name (字段1, 字段2，……) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">VALUES</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (字段1值, 字段2值, ……);</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>mysql数据库中没有upsert可用下方示例替换</p>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- 说明</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">INSERT INTO</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> table_name (字段1, 字段2, ……)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">values</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (字段1值, 字段2值, ……)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">ON</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> DUPLICATE </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">KEY</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> UPDATE</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- 示例</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">INSERT INTO</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> employee (id, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, email) </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">VALUES</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Danny</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">danny.liu@krem.corp</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">ON</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> DUPLICATE </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">KEY</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> UPDATE</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>PostgreSQL数据库中没有upsert可用下方示例替换</p>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- 说明</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">INSERT INTO</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> table_name (字段1, 字段2, ……)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">values</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (字段1值, 字段2值, ……)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">ON</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> CONFLICT 冲突字段 冲突动作;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- 示例</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">INSERT INTO</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> employees (id, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, email) </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">VALUES</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Danny</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">danny.liu@krem.corp</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">ON</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> CONFLICT (id) DO </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">UPDATE</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_9-获取明天的时间\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_9-获取明天的时间\"><span>9. 获取明天的时间</span></a></h2>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">SELECT</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> DATE_ADD(</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">now</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">()</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, INTERVAL </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> DAY</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">AS</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> tomorrow;</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h2 id=\"_10-事务的使用\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_10-事务的使用\"><span>10. 事务的使用</span></a></h2>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">START TRANSACTION</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">SELECT</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> value</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> FROM</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> serial_number </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">FOR</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> UPDATE</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">UPDATE</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> serial_number </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">SET</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> value</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> =</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> value</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> +</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">COMMIT</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>代码说明：</p>\n<ul>\n<li>START TRANSACTION：开启一个事务</li>\n<li>SELECT value FROM serial_number FOR UPDATE;使用FOR UPDATE语句锁定serial_number表的记录，确保其他事务不能同时读取和修改该记录。</li>\n<li>UPDATE serial_number SET value = value + 1：将序列号的值加1。</li>\n<li>COMMIT：提交事务。</li>\n</ul>\n<h2 id=\"_11-uuid-生成唯一主键\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_11-uuid-生成唯一主键\"><span>11.UUID()：生成唯一主键</span></a></h2>\n</template>","contentStripped":"<h2 id=\"_1-with-as\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-with-as\"><span>1. with....as</span></a></h2>\n<p>with...as也叫子查询，用来定义一个sql片段，且该片段会被整个sql语句反复使用很多次，这个sql片段就相当于是一个公用临时表</p>\n<p>例如：</p>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- 针对一个别名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">with</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> temp </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">as</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> aTable)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> temp</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- 针对多个别名</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">with</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">tmp </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">as</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> tb_name),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">tmp2 </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">as</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> tb_name2),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">tmp3 </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">as</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> tb_name3),</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">....</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">tempn </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">as</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> tb_namen)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> from</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> tmp,tmp2 </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">where</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\"> tmp</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">id</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">tmp2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"--shiki-light:#A65E2B;--shiki-dark:#C99076\">id</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_2-find-in-set\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-find-in-set\"><span>2. find_in_set</span></a></h2>\n<p>用法示例</p>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- find_in_set(搜索字段，被搜索字段)用来查询被搜索字段以逗号分隔的数据</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> find_in_set(</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">a</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">a,b,c,d,e</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_3-case-when-then\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-case-when-then\"><span>3. case  when  then</span></a></h2>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">SELECT</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, (</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">CASE</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">             WHEN</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sex</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> THEN</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">男</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">             WHEN</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sex</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> THEN</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">女</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">             WHEN</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> sex</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">3</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> THEN</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">神仙</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">             ELSE</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">性别出现异常</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">            END</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">        ) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">AS</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> 性别 </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">FROM</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> person;</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_4-ifnull\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_4-ifnull\"><span>4. IFNULL</span></a></h2>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- 如果成绩为空则显示为0</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">SELECT</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> ifnull</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(score, </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">FROM</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> student;</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_5-if\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_5-if\"><span>5.IF</span></a></h2>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- 如果分数大于90分则为几个，否则为不及格</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">SELECT</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> IF</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(score</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">90</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">及格</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">不及格</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">FROM</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> student;</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_6-if-else\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_6-if-else\"><span>6. IF....ELSE</span></a></h2>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">IF</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> search_condition </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">THEN</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">\tstatement_list</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">ELSEIF search_condition </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">THEN</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">\tstatement_list</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">ELSE</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">\tstatement_list</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">END</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> IF</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_7-data-format\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_7-data-format\"><span>7. data_format</span></a></h2>\n<p>时间格式化</p>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">select</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> date_format</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">(</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">NOW</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">()</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">,</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">%Y-%m-%d</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h2 id=\"_8-upsert\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_8-upsert\"><span>8. upsert</span></a></h2>\n<p>语法：</p>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">UPSERT </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">INTO</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> table_name (字段1, 字段2，……) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">VALUES</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (字段1值, 字段2值, ……);</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><p>mysql数据库中没有upsert可用下方示例替换</p>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- 说明</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">INSERT INTO</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> table_name (字段1, 字段2, ……)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">values</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (字段1值, 字段2值, ……)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">ON</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> DUPLICATE </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">KEY</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> UPDATE</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- 示例</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">INSERT INTO</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> employee (id, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, email) </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">VALUES</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Danny</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">danny.liu@krem.corp</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">ON</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> DUPLICATE </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">KEY</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> UPDATE</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>PostgreSQL数据库中没有upsert可用下方示例替换</p>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- 说明</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">INSERT INTO</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> table_name (字段1, 字段2, ……)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">values</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (字段1值, 字段2值, ……)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">ON</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> CONFLICT 冲突字段 冲突动作;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0ADA0;--shiki-dark:#758575DD\">-- 示例</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">INSERT INTO</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> employees (id, </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">name</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, email) </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">VALUES</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> (</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">Danny</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#B56959;--shiki-dark:#C98A7D\">danny.liu@krem.corp</span><span style=\"--shiki-light:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">ON</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> CONFLICT (id) DO </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">UPDATE</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"_9-获取明天的时间\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_9-获取明天的时间\"><span>9. 获取明天的时间</span></a></h2>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">SELECT</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> DATE_ADD(</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">now</span><span style=\"--shiki-light:#999999;--shiki-dark:#666666\">()</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">, INTERVAL </span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> DAY</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">) </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">AS</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> tomorrow;</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div></div></div><h2 id=\"_10-事务的使用\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_10-事务的使用\"><span>10. 事务的使用</span></a></h2>\n<div class=\"language-sql line-numbers-mode\" data-ext=\"sql\" data-title=\"sql\"><button class=\"copy\" title=\"复制代码\" data-copied=\"已复制\"></button><pre class=\"shiki shiki-themes vitesse-light vitesse-dark vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">START TRANSACTION</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">SELECT</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> value</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> FROM</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> serial_number </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">FOR</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> UPDATE</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">UPDATE</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\"> serial_number </span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">SET</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> value</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> =</span><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\"> value</span><span style=\"--shiki-light:#AB5959;--shiki-dark:#CB7676\"> +</span><span style=\"--shiki-light:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#1E754F;--shiki-dark:#4D9375\">COMMIT</span><span style=\"--shiki-light:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span></code></pre>\n\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><p>代码说明：</p>\n<ul>\n<li>START TRANSACTION：开启一个事务</li>\n<li>SELECT value FROM serial_number FOR UPDATE;使用FOR UPDATE语句锁定serial_number表的记录，确保其他事务不能同时读取和修改该记录。</li>\n<li>UPDATE serial_number SET value = value + 1：将序列号的值加1。</li>\n<li>COMMIT：提交事务。</li>\n</ul>\n<h2 id=\"_11-uuid-生成唯一主键\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_11-uuid-生成唯一主键\"><span>11.UUID()：生成唯一主键</span></a></h2>\n","tagOpen":"<template>","tagClose":"</template>"},"script":null,"scriptSetup":null,"scripts":[],"styles":[],"customBlocks":[]},"content":"## 1. with....as\r\n\r\nwith...as也叫子查询，用来定义一个sql片段，且该片段会被整个sql语句反复使用很多次，这个sql片段就相当于是一个公用临时表\r\n\r\n例如：\r\n\r\n```sql\r\n-- 针对一个别名\r\nwith temp as (select * from aTable)\r\nselect * from temp\r\n-- 针对多个别名\r\nwith\r\ntmp as (select * from tb_name),\r\ntmp2 as (select * from tb_name2),\r\ntmp3 as (select * from tb_name3),\r\n....\r\ntempn as (select * from tb_namen)\r\nselect * from tmp,tmp2 where tmp.id=tmp2.id\r\n```\r\n\r\n## 2. find_in_set\r\n\r\n用法示例\r\n\r\n```sql\r\n-- find_in_set(搜索字段，被搜索字段)用来查询被搜索字段以逗号分隔的数据\r\nselect find_in_set('a', 'a,b,c,d,e')\r\n```\r\n\r\n## 3. case  when  then\r\n\r\n```sql\r\nSELECT name, (CASE\r\n             WHEN sex=1 THEN '男'\r\n             WHEN sex=2 THEN '女'\r\n             WHEN sex=3 THEN '神仙'\r\n             ELSE '性别出现异常'\r\n            END\r\n        ) AS 性别 FROM person;\r\n```\r\n\r\n## 4. IFNULL\r\n\r\n```SQL\r\n-- 如果成绩为空则显示为0\r\nSELECT ifnull(score, 0) FROM student;\r\n```\r\n\r\n## 5.IF\r\n\r\n```SQL\r\n-- 如果分数大于90分则为几个，否则为不及格\r\nSELECT IF(score>90,'及格','不及格') FROM student;\r\n```\r\n\r\n## 6. IF....ELSE\r\n\r\n```SQL\r\nIF search_condition THEN\r\n\tstatement_list\r\n \r\nELSEIF search_condition THEN\r\n\tstatement_list\r\n \r\nELSE\r\n\tstatement_list\r\n \r\nEND IF;\r\n```\r\n\r\n## 7. data_format\r\n\r\n时间格式化\r\n\r\n```sql\r\nselect date_format(NOW(),'%Y-%m-%d') \r\n```\r\n\r\n## 8. upsert\r\n\r\n语法：\r\n\r\n```sql\r\nUPSERT INTO table_name (字段1, 字段2，……) VALUES (字段1值, 字段2值, ……);\r\n```\r\n\r\n\r\n\r\nmysql数据库中没有upsert可用下方示例替换\r\n\r\n```sql\r\n-- 说明\r\nINSERT INTO table_name (字段1, 字段2, ……)\r\nvalues (字段1值, 字段2值, ……)\r\nON DUPLICATE KEY UPDATE\r\n-- 示例\r\nINSERT INTO employee (id, name, email) \r\nVALUES (2, 'Danny', 'danny.liu@krem.corp')\r\nON DUPLICATE KEY UPDATE;\r\n```\r\n\r\n\r\n\r\nPostgreSQL数据库中没有upsert可用下方示例替换\r\n\r\n```sql\r\n-- 说明\r\nINSERT INTO table_name (字段1, 字段2, ……)\r\nvalues (字段1值, 字段2值, ……)\r\nON CONFLICT 冲突字段 冲突动作;\r\n-- 示例\r\nINSERT INTO employees (id, name, email) \r\nVALUES (2, 'Danny', 'danny.liu@krem.corp')\r\nON CONFLICT (id) DO UPDATE;\r\n```\r\n\r\n## 9. 获取明天的时间\r\n\r\n```sql\r\nSELECT DATE_ADD(now(), INTERVAL 1 DAY) AS tomorrow;\r\n```\r\n\r\n## 10. 事务的使用\r\n\r\n```sql\r\nSTART TRANSACTION;\r\nSELECT value FROM serial_number FOR UPDATE;\r\nUPDATE serial_number SET value = value + 1;\r\nCOMMIT;\r\n```\r\n\r\n代码说明：\r\n\r\n+ START TRANSACTION：开启一个事务\r\n+ SELECT value FROM serial_number FOR UPDATE;使用FOR UPDATE语句锁定serial_number表的记录，确保其他事务不能同时读取和修改该记录。\r\n+ UPDATE serial_number SET value = value + 1：将序列号的值加1。\r\n+ COMMIT：提交事务。\r\n\r\n## 11.UUID()：生成唯一主键","excerpt":"","includedFiles":[],"tasklists":0,"title":"","headers":[{"level":2,"title":"1. with....as","slug":"_1-with-as","link":"#_1-with-as","children":[]},{"level":2,"title":"2. find_in_set","slug":"_2-find-in-set","link":"#_2-find-in-set","children":[]},{"level":2,"title":"3. case  when  then","slug":"_3-case-when-then","link":"#_3-case-when-then","children":[]},{"level":2,"title":"4. IFNULL","slug":"_4-ifnull","link":"#_4-ifnull","children":[]},{"level":2,"title":"5.IF","slug":"_5-if","link":"#_5-if","children":[]},{"level":2,"title":"6. IF....ELSE","slug":"_6-if-else","link":"#_6-if-else","children":[]},{"level":2,"title":"7. data_format","slug":"_7-data-format","link":"#_7-data-format","children":[]},{"level":2,"title":"8. upsert","slug":"_8-upsert","link":"#_8-upsert","children":[]},{"level":2,"title":"9. 获取明天的时间","slug":"_9-获取明天的时间","link":"#_9-获取明天的时间","children":[]},{"level":2,"title":"10. 事务的使用","slug":"_10-事务的使用","link":"#_10-事务的使用","children":[]},{"level":2,"title":"11.UUID()：生成唯一主键","slug":"_11-uuid-生成唯一主键","link":"#_11-uuid-生成唯一主键","children":[]}]}}
