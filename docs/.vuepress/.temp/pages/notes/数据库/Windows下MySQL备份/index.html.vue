<template><div><h1 id="前期工作" tabindex="-1"><a class="header-anchor" href="#前期工作"><span>前期工作</span></a></h1>
<p>需要为Windows创建定时任务，按时执行bat文件</p>
<h2 id="以天为单位备份-autobackupmysqldbbyday-bat" tabindex="-1"><a class="header-anchor" href="#以天为单位备份-autobackupmysqldbbyday-bat"><span>以天为单位备份（ AutoBackUpMysqlDbByDay.bat）</span></a></h2>
<div class="language-bat line-numbers-mode" data-ext="bat" data-title="bat"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" v-pre=""><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676">    @</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">echo</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375"> off</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">    rem</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD"> 备份文件存放路径</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">    set</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A"> SrcDir</span><span style="--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">C:\mysql_bak</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">    set</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A"> TwoDir</span><span style="--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">E:\mysql_bak_copy</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">    rem</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD"> 当前日期作为文件名一部分</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD">    ::时间不是两位补0</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">    if</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">date</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:~</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">5</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">2</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676"> lss</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">10</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#999999;--shiki-dark:#666666"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">set mm=0</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A">date</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:~</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">6</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">1</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%)</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375"> else</span><span style="--shiki-light:#999999;--shiki-dark:#666666"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">set mm=</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A">date</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:~</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">5</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">2</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%)</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">    if</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">date</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:~</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">8</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">2</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676"> lss</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">10</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#999999;--shiki-dark:#666666"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">set dd=0</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A">date</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:~</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">9</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">1</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%)</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375"> else</span><span style="--shiki-light:#999999;--shiki-dark:#666666"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">set dd=</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A">date</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:~</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">8</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">2</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%)</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">    if</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">time</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:~</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">0</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">2</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676"> lss</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">10</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#999999;--shiki-dark:#666666"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">set hh=0</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A">time</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:~</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">1</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">1</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%)</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375"> else</span><span style="--shiki-light:#999999;--shiki-dark:#666666"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">set hh=</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A">time</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:~</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">0</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">2</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%)</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">    if</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">time</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:~</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">3</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">2</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676"> lss</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">10</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#999999;--shiki-dark:#666666"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">set nn=0</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A">time</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:~</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">4</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">1</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%)</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375"> else</span><span style="--shiki-light:#999999;--shiki-dark:#666666"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">set nn=</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A">time</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:~</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">3</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">2</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%)</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD">    :: 年月日_时分秒</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">    set</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A">  timer</span><span style="--shiki-light:#999999;--shiki-dark:#666666">=%</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A">date</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:~</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">0</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">4</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%%</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A">mm</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%%</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A">dd</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">_</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A">hh</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%%</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A">nn</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">    rem</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD"> 指定天数</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">    set</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A"> DaysAgo</span><span style="--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">15</span></span>
<span class="line"><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">    "</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">C:\Program Files\mysql-5.7.10-winx64\bin\mysqldump.exe</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> --opt -u 用户名 --password=密码 数据库名 </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676">></span><span style="--shiki-light:#999999;--shiki-dark:#666666"> %</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A">SrcDir</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">\contract_db_</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A">timer</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">.sql</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676">    @</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">echo</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375"> on</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676">    @</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">echo</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375"> off</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD">    ::演示：删除指定路径下指定天数之前（以文件的最后修改日期为准）的文件。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD">    ::如果演示结果无误，把del前面的echo去掉，即可实现真正删除。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD">    ::forfiles /p %SrcDir% /s /m *.* /d -%DaysAgo% /c "cmd /c echo del /f /q /a @path"</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD">    ::本例需要Win2003/Vista/Win7系统自带的forfiles命令的支持</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">    rem</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD"> 删除过期文件</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">    forfiles</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> /p </span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A">SrcDir</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> /s /m *.* /d -</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A">DaysAgo</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> /c </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">cmd /c   del /f /q /a @path</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">    rem</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD">  异盘拷贝</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">    copy</span><span style="--shiki-light:#999999;--shiki-dark:#666666">  %</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A">SrcDir</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">\xx_db_</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A">timer</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">.sql </span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A">TwoDir</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">\</span></span></code></pre>

<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="以周为单位备份-autobackupmysqldbbyweekl-bat" tabindex="-1"><a class="header-anchor" href="#以周为单位备份-autobackupmysqldbbyweekl-bat"><span>以周为单位备份（AutoBackUpMysqlDbByWeekl.bat）</span></a></h1>
<div class="language-bat line-numbers-mode" data-ext="bat" data-title="bat"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" v-pre=""><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676">    @</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">echo</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375"> off</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">    rem</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD"> 备份文件存放路径</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">    rem</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD"> 备份文件存放路径</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">    set</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A"> SrcDir</span><span style="--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">D:\htgl\autobak\weekbak</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">    set</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A"> TwoDir</span><span style="--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">C:\htgl\autobak\weekbak</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">    rem</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD"> 当前日期作为文件名一部分</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">    set</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">Ymd</span><span style="--shiki-light:#999999;--shiki-dark:#666666">=%</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">date</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:~</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">4</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%%</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">date</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:~</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">5</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">2</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%%</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">date</span><span style="--shiki-light:#999999;--shiki-dark:#666666">:~</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">8</span><span style="--shiki-light:#999999;--shiki-dark:#666666">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">2</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">    rem</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD"> 指定天数</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">    set</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A"> DaysAgo</span><span style="--shiki-light:#999999;--shiki-dark:#666666">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91">60</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">    "</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">C:\Program Files\MySQL\MySQL Server 5.7\bin\mysqldump.exe</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> --opt -u 用户名 --password=密码 数据库名 </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676">></span><span style="--shiki-light:#999999;--shiki-dark:#666666"> %</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A">SrcDir</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">\htgl_db_</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A">Ymd</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">.sql</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676">    @</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">echo</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375"> on</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676">    @</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">echo</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375"> off</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD">    ::演示：删除指定路径下指定天数之前（以文件的最后修改日期为准）的文件。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD">    ::如果演示结果无误，把del前面的echo去掉，即可实现真正删除。</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD">    ::forfiles /p %SrcDir% /s /m *.* /d -%DaysAgo% /c "cmd /c echo del /f /q /a @path"</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD">    ::本例需要Win2003/Vista/Win7系统自带的forfiles命令的支持</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">    rem</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD"> 删除过期文件</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">    forfiles</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> /p </span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A">SrcDir</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> /s /m *.* /d -</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A">DaysAgo</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE"> /c </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D">cmd /c   del /f /q /a @path</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77">"</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">    rem</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD">  异盘拷贝</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375">    copy</span><span style="--shiki-light:#999999;--shiki-dark:#666666">  %</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A">SrcDir</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">\xx_db_</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A">Ymd</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">.sql </span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A">TwoDir</span><span style="--shiki-light:#999999;--shiki-dark:#666666">%</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE">\</span></span></code></pre>

<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></template>


